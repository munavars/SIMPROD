<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="Yokohama">
    <meta name="keyword" content="">

    <title>Blank</title>

    <!-- Bootstrap core CSS -->
    <link href="resources/css/bootstrap.min.css" rel="stylesheet">
    <link href="resources/css/bootstrap-reset.css" rel="stylesheet">
    <!--external css-->
    <link href="resources/assets/font-awesome/css/font-awesome.css" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="resources/assets/bootstrap-datepicker/css/datepicker.css" />
    <link rel="stylesheet" type="text/css" href="resources/assets/bootstrap-daterangepicker/daterangepicker-bs3.css" />
<!--     <link rel="stylesheet" type="text/css" href="resources/assets/jquery-multi-select/css/multi-select.css" /> -->
    <link rel="stylesheet" type="text/css" href="resources/assets/bootstrap-timepicker/compiled/timepicker.css" />
    <link rel="stylesheet" type="text/css" href="resources/assets/bootstrap-datetimepicker/css/datetimepicker.css" />
    <link rel="stylesheet" type="text/css" href="resources/assets/bootstrap-fileupload/bootstrap-fileupload.css" />
    <link rel="stylesheet" href="resources/assets/data-tables/DT_bootstrap.css" />

    <!--bootstrap switcher-->
    <link rel="stylesheet" type="text/css" href="resources/assets/bootstrap-switch/static/stylesheets/bootstrap-switch.css" />
    <!--select 2-->
    <link rel="stylesheet" type="text/css" href="resources/assets/select2/css/select2.min.css"/>
    <!--right slidebar-->
<!--     <link href="resources/css/slidebars.css" rel="stylesheet"> -->
 
    <!-- Custom styles for this template -->
    
	<link href="resources/css/style.css" rel="stylesheet">
    <link href="resources/css/style-responsive.css" rel="stylesheet" />

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 tooltipss and media queries -->
    <!--[if lt IE 9]>
      <script src="resources/js/html5shiv.js"></script>
      <script src="resources/js/respond.min.js"></script>
    <![endif]-->
    
<!--    <script src="resources/js/prodTreadParts.js"></script> -->

      <script type="text/javascript">
         function sync()
         {
           var n1 = document.getElementById('include');
           var n2 = document.getElementById('input4');
           n2.value = n1.value;
         }
         //Export to Excel 
         var tableToExcel = (function() {
         	  var uri = 'data:application/vnd.ms-excel;base64,'
         	    , template = '<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40"><head><!--[if gte mso 9]><xml><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--></head><body><table>{table}</table></body></html>'
         	    , base64 = function(s) { return window.btoa(unescape(encodeURIComponent(s))) }
         	    , format = function(s, c) { return s.replace(/{(\w+)}/g, function(m, p) { return c[p]; }) }
         	  return function(table, name) {
         	    if (!table.nodeType) table = document.getElementById(table)
         	    var ctx = {worksheet: name || 'Worksheet', table: table.innerHTML}
         	   // window.location.href = uri + base64(format(template, ctx))
      		    var a = document.createElement('a');
      		    a.href = uri + base64(format(template, ctx));
      			a.download =  'pricing'+'.xls';
      		    a.click(); 
         	  }
         	})()
      </script>
      

    <script src="http://code.jquery.com/jquery-1.11.3.min.js"></script>
    <script src="resources/js/bootstrap.min.js"></script>
    <script src="http://code.jquery.com/ui/1.11.1/jquery-ui.min.js"></script>
     <script src="resources/js/jquery-ui-1.9.2.custom.min.js"></script>
    <!-- Ignite UI Required Combined JavaScript Files -->
  <!--Form Validation-->
      <script src="resources/js/bootstrap-validator.min.js" type="text/javascript"></script>
      <!--Form Wizard-->
      <!--script src="js/jquery.steps.min.js" type="text/javascript"></script-->
      <script src="resources/js/jquery.validate.min.js" type="text/javascript"></script>
            <script src="resources/js/slidebars.min.js"></script>
      <script type="text/javascript" src="resources/assets/bootstrap-datepicker/js/bootstrap-datepicker.js"></script>
      <script type="text/javascript" src="resources/assets/bootstrap-datetimepicker/js/bootstrap-datetimepicker.js"></script>
      <script type="text/javascript" src="resources/assets/bootstrap-daterangepicker/moment.min.js"></script>
      <script type="text/javascript" src="resources/assets/bootstrap-daterangepicker/daterangepicker.js"></script>


<style>
#drop{
	border:2px dashed #bbb;
	-moz-border-radius:5px;
	-webkit-border-radius:5px;
	border-radius:5px;
	padding:25px;
	text-align:center;
	font:20pt bold,"Vollkorn";color:#bbb
}
#b64data{
	width:100%;
}
a { text-decoration: none }
</style>

		<script src="resources/js/editablegrid.js"></script>
		<script src="resources/js/editablegrid_renderers.js" ></script>
		<script src="resources/js/editablegrid_editors.js" ></script>
		<script src="resources/js/editablegrid_validators.js" ></script>
		<script src="resources/js/editablegrid_utils.js" ></script>
		<script src="resources/js/editablegrid_charts.js" ></script>
		<link rel="stylesheet" href="resources/css/editablegrid.css" type="text/css" media="screen">
		
		<style>
			body { font-family:'lucida grande', tahoma, verdana, arial, sans-serif; font-size:11px; }
			h1 { font-size: 15px; }
			a { color: #548dc4; text-decoration: none; }
			a:hover { text-decoration: underline; }
			table.testgrid { border-collapse: collapse; border: 1px solid #CCB; width: 800px; }
			table.testgrid td, table.testgrid th { padding: 5px; border: 1px solid #E0E0E0; }
			table.testgrid th { background: #E5E5E5; text-align: left; }
			input.invalid { background: red; color: #FDFDFD; }
		</style>




<script src="resources/js/cpexcel.js"></script>
<script src="resources/js/shim.js"></script>
<script src="resources/js/jszip.js"></script>
<script src="resources/js/xlsx.js"></script>
<script>
var fileData ={};
/*jshint browser:true */
/*global XLSX */
var X = XLSX;
var XW = {
	/* worker message */
	msg: 'xlsx',
	/* worker scripts */
	rABS: './xlsxworker2.js',
	norABS: './xlsxworker1.js',
	noxfer: './xlsxworker.js'
};

var rABS = typeof FileReader !== "undefined" && typeof FileReader.prototype !== "undefined" && typeof FileReader.prototype.readAsBinaryString !== "undefined";
if(!rABS) {
	document.getElementsByName("userabs")[0].disabled = true;
	document.getElementsByName("userabs")[0].checked = false;
}

var use_worker = typeof Worker !== 'undefined';
if(!use_worker) {
	document.getElementsByName("useworker")[0].disabled = true;
	document.getElementsByName("useworker")[0].checked = false;
}

var transferable = use_worker;
if(!transferable) {
	document.getElementsByName("xferable")[0].disabled = true;
	document.getElementsByName("xferable")[0].checked = false;
}

var wtf_mode = false;

function to_csv(workbook) {
	var result = [];
	workbook.SheetNames.forEach(function(sheetName) {
		var csv = X.utils.sheet_to_csv(workbook.Sheets[sheetName]);
		if(csv.length > 0){
			result.push(sheetName);
			result.push("");
			result.push(csv);
		}
	});
	return result.join("\n");
}


function fixdata(data) {
	var o = "", l = 0, w = 10240;
	for(; l<data.byteLength/w; ++l) o+=String.fromCharCode.apply(null,new Uint8Array(data.slice(l*w,l*w+w)));
	o+=String.fromCharCode.apply(null, new Uint8Array(data.slice(l*w)));
	return o;
}

function to_json(workbook) {
	var result = {};
	workbook.SheetNames.forEach(function(sheetName) {
		var roa = X.utils.sheet_to_row_object_array(workbook.Sheets[sheetName]);
		if(roa.length > 0){
			result[sheetName] = roa;
		}
	});
	return result;
}





var global_wb;
function process_wb(wb) {
	global_wb = wb;
	var output = "";
	
	output = to_csv(wb);
	
	buildTable(output);


}

		function removeCommaBetweenDoubleQuote(aString) {
			var result = aString
			// find first occurance of "
			var iStart = aString.indexOf('"');
			var iEnd = iStart + 1;
			if (iStart >= 0) {
				// find ending quote "
				iEnd = aString.indexOf('"', iEnd);
				if (iEnd > 0) {
					var value = aString.substring(iStart+1, iEnd);
					// alert("Before value "+value);
					var i = value.indexOf(',');
					if (i > 0) {
						//value.replace(',', '');
						value = value.substring(0,i) + value.substring(i+1);
					}
					// alert("After value "+value);
					result = aString.substring(0, iStart) + value + aString.substring(iEnd+1);
				}
			}
			return result;
		}


			function buildTable(output) {
			
			var rows = output.split('\n');
			var rowData = [];
			var title = rows[0];
			var data = [];
			var columnNames = [];
			
			// this approach is interesting if you need to dynamically create data in Javascript 
				var metadata = [];
				
			// heading built successfully.  rows[0] = wd sheet name, rows[1] = blank space
			for (var j = 0; j < rows.length; ++j) {
				if (rows[j].length > 0) {
					// alert("Before "+rows[j]);
					rows[j] = removeCommaBetweenDoubleQuote(rows[j]);
					// alert("After "+rows[j]);
					var oneRow = rows[j].split(",");
					if (rows[j].length > 0) {
						if (j == 2 ) {
							columnNames = oneRow;
							for (var k = 0; k < columnNames.length; ++k) {
								metadata.push({ name: columnNames[k], label: columnNames[k], datatype: "string", editable: true});
								// alert("metadata: "+k+" "+columnNames[k]);
							}
						} else {
							if (j > 2) {
							// data.push({ name: oneRow[i], label: oneRow[i], datatype: "string", editable: true});
							
								var display2 = {};
								var rowValues = {};
								// id: 1
								var icount = j - 2;
								display2["id"] = icount;
								for (var i = 0; i < columnNames.length; ++i) {
									rowValues[columnNames[i]] = oneRow[i];
								}
								display2["values"] = rowValues;

								var myData = JSON.stringify(rowValues);
								// alert(myData);
								data.push({id: icount, values: rowValues});
							}
						}
					}
				}
			}

				editableGrid = new EditableGrid(title);
				editableGrid.load({"metadata": metadata, "data": data});
				editableGrid.renderGrid("tablecontent", "testgrid","testgrid");
				fileData = data;
			} 

			
			
			

function handleFile(e) {

	rABS = false;
	use_worker = false;
 
	var files = e.target.files;
	var f = files[0];
	{
		var reader = new FileReader();
		var name = f.name;
		reader.onload = function(e) {
			if(typeof console !== 'undefined') console.log("onload", new Date(), rABS, use_worker);
			var data = e.target.result;
			if(use_worker) {
				xw(data, process_wb);
			} else {
				var wb;
				if(rABS) {
					wb = X.read(data, {type: 'binary'});
				} else {
					var arr = fixdata(data);
					wb = X.read(btoa(arr), {type: 'base64'});
				}
				process_wb(wb);
			}
		};
		if(rABS) reader.readAsBinaryString(f);
		else reader.readAsArrayBuffer(f);
	}
}



</script>
<!-- 
<script type="text/javascript">
	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-36810333-1']);
	_gaq.push(['_trackPageview']);

	(function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	})();
</script>
 -->
 <script type="text/javascript">
 	var responseOnload;
			$(window).ready(function(){
			
				var url="/SIM/pricing/v1/getPricingDetails";
	         	$.ajax({ 
	             	type: "GET",
	             	dataType: "json",
	            	url: url,
	            	async: false,
	             	success: function(response){
	             		responseOnload = response.data;
	             		
					fnPopulateDropdown('termsCode_inputselect', response.data.dropdownList.termsCodeList);
              	$('#termsCode_inputselect').val(response.data.dropdownList.termsCodeList[0].key);
              	if(response.data.dropdownList.termsCodeList[0].key == response.data.dropdownList.definitionList[0].key){
            	$('#program_terms_definition').val(response.data.dropdownList.definitionList[0].value);
            	}
              	if(response.data.dropdownList.termsCodeList[0].key == response.data.dropdownList.dueDatesList[0].key){
            	$('#program_terms_duedates').val(response.data.dropdownList.dueDatesList[0].value);
            	}
            		if(response.data.dropdownList.termsCodeList[0].key == response.data.dropdownList.cashList[0].key){
            	$('#program_terms_cash').val(response.data.dropdownList.cashList[0].value);
            	}
               	fnPopulateDropdown('Other_Ship_Reqs_inputselect', response.data.dropdownList.otherShipReqsList);
             	fnPopulateDropdown('custByName_inputselect', responseOnload.dropdownList.custBillToList);
             	$("#customerGroup").val($("#custByName_inputselect").val());
               	
	             	},
	             	failure: function(response){
	             		alert("Wrongly done");
	             	}
	         	});
	         	
	         	var test,selectTerm;
            $("input[name=optionsRadiosSourcePathName]").on( "click", function() {
				 test = $(this).val();
				 if(test == 'Group'){
				
				fnPopulateDropdown('custByName_inputselect', responseOnload.dropdownList.groupList);
				$("#customerGroup").val($("#custByName_inputselect").val());
				}
				else if(test == 'BillTo'){
				
				fnPopulateDropdown('custByName_inputselect', responseOnload.dropdownList.custBillToList);
				$("#customerGroup").val($("#custByName_inputselect").val());
				}
				else if(test == 'Name'){
					
					fnPopulateDropdown('custByName_inputselect', responseOnload.dropdownList.custByNameList);
					$("#customerGroup").val($("#custByName_inputselect").val());
				}	else if(test == 'ShipTo'){
				fnPopulateDropdown('custByName_inputselect', responseOnload.dropdownList.custShipToList);
				$("#customerGroup").val($("#custByName_inputselect").val());
				
				}
				
				
    		});
    		$("select[name=custByName_inputselect]").on( "change", function() {
				var test = $(this).val();
			
				$("#customerGroup").val(test);
				});
				$("select[name=termsCode_inputselect]").on( "change", function() {
				 selectTerm = $(this).val();
				var checkDefn =responseOnload.dropdownList.definitionList;
				var checkDueDates=responseOnload.dropdownList.dueDatesList;
				var checkCash=responseOnload.dropdownList.cashList;
				fnPopulateProgramTerms('program_terms_definition', checkDefn,selectTerm);
				fnPopulateProgramTerms('program_terms_duedates', checkDueDates,selectTerm);
				fnPopulateProgramTerms('program_terms_cash', checkCash,selectTerm);
				program_terms_cash
			});
    		function resetFormForMandatoryCheck(elementId){
         		if( $('#'+ elementId).valid()){
				   $('#'+ elementId).validate().resetForm(); 
				}
         	}
         	
         	
         	function fnPopulateDropdown(elementId, items){
	         	if(items != null){
	         		$('#'+ elementId).empty();
	         		$.each(items, function (i, item) {
					    $('#'+ elementId).append($('<option>', { 
					        value: item.key,
					        text : item.value 
					    },'</option>' ));
					    
					});
					//resetFormForMandatoryCheck(elementId);
	         	}
			}
			function fnPopulateProgramTerms(elementId, items,item){
			var check = item;
	         	if(items != null){
	         	console.log(items);
	         		$('#'+ elementId).empty();
	         		$.each(items, function (i, item) {
					   /*  $('#'+ elementId).append($('<option>', { 
					        value: item.key,
					        text : item.value 
					    },'</option>' )); */
					    if(check == item.key){
					    $('#'+ elementId).val(item.value); 
					    }
					});
					//resetFormForMandatoryCheck(elementId);
	         	}
			}	
			});
		
			</script>
			<script type="text/javascript">
			var responseOnload = {};
			function saveDraft(){
         		//responseOnload.status = "3";
         		prepareDataForSubmit();
         		fnCallService();
         		
         	}
         	var formData=[];
         	function prepareDataForSubmit(){
         		//responseOnload.url = window.location.href;
				formData= $('form#pricingRequest').serializeArray();
				responseOnload.customerType=formData[0].value;
				responseOnload.customerGroup=formData[1].value;
				responseOnload.customerId=formData[2].value;
				responseOnload.userComments=formData[4].value;
				responseOnload.termCode=formData[5].value;
				responseOnload.definition=formData[6].value;
				responseOnload.dueDates=formData[7].value;
				responseOnload.cash=formData[8].value;
				responseOnload.shippingReqs=formData[9].value;
				responseOnload.otherShippingReqs=formData[10].value;
				var fileDataList = [];
			
				$.each(fileData, function(key, data) {
					console.log( $.datepicker.parseDate( "mm/dd/yy", data.values['BEG DATE']));
					var fileDataRow = {'id': data.id, 'programId': data.id, 'part':data.values[' PART#'], 'addChangeDel': data.values['ADD CHG DEL'], 'beginDate':  $.datepicker.parseDate( "mm/dd/yy", data.values['BEG DATE']), 'bonusUnits': data.values['BONUS UNITS Y/N'], 'commissionable': data.values['COMM Y/N'], 'comments': data.values['COMMENT'], 'endDate':  $.datepicker.parseDate( "mm/dd/yy", data.values['END DATE']), 'invoiceDisc': data.values['INVOICE DSC %'],'netPrice': data.values['NET PRICE'], 'prodLine': data.values['PROD LINE'], 'tread': data.values['TREAD'] };
					fileDataList.push(fileDataRow);
				});
				//console.log(fileDataList);
				responseOnload.pricingDetailList=fileDataList;
						
 				}
         	function fnCallService(){
				/*Service call to save the data.*/	
			    $.ajax({
					type: "POST",
					url: "/SIM/pricing/v1/savePricingDetails",
					dataType: 'json',
					contentType: 'application/json',
					data: JSON.stringify(responseOnload),
					success: function (response) {
			            if (response != null && response.data.success == true) {
			            	responseOnload = response.data;
			            	$('#myModal1').modal('toggle');
         					$("#confirmMessage").html("Data saved successfully !!!");
							$('#myModal4').modal('toggle');
			            } else {
			              	$('#myModal1').modal('toggle');
         					$("#errorMessage").html("Issue while saving the data. Please correct data entered.!!");
							$('#myModal5').modal('toggle');
			            
							//alert("Issue while saving the data. Please try again after sometime.!!");
			            }
					},
					failure: function(response){
					 	$('#myModal1').modal('toggle');
         				$("#errorMessage").html("Issue while saving the data. Please try again after sometime.!!");
						$('#myModal5').modal('toggle');
						//alert("Issue while saving the data. Please try again after sometime.!!");
					}
			    });
			}
			function validateBeforeSubmit(modalId){
				/**If valid, it will toggle the corresponding modal.
				If there is some error, error modal will be toggled.*/
				
				 if($("#pricingRequest").valid()){
					$(modalId).modal('toggle');
				}
				else{
					$("#errorMessageModal").html("Please rectify the highlighted errors !!!");
					$('#myModal5').modal('toggle');
				} 
			}
			</script>
	<!--  Validation setup Begins -->
    <script type="text/javascript">
      $(document).ready(function () {
			/* $.validator.addMethod("actualMarkerCheck", function (value, element) {
				var isSame = false;
                    $('#tier-schedule tbody').find('tr').each(function(i) {
                    	 var tds = $(this).find('td'),
                         marker = tds.eq(0).text();
                    	 if(marker==value){
                    	 	isSame = true;
                    	 }
                    });							
			    return isSame;
			}, 'Accrued Tier should match maker value available'); */
      
			$("#pricingRequest").validate({
				rules: {
					optionsRadiosSourcePathName: {
						required: true
					},
					custByName_inputselect:{
						required: true
					},
					/* customeID: {
						required: true
					},
 */					termsCode_inputselect: {
						required: true
					},
					optionsRadiosShippingProgram: {
						required: true
					},
					Other_Ship_Reqs_inputselect:{
						required: true
					},
					
				},
				messages: {
					required: "This field is required",
				   	/* amount: {
					   	number: "Please enter only numeric values"
				   	}, */
				}
			});
			});
          	/* var form = $("#wizard-validation-form");
			onFinishing: {
			    form.validate().settings.ignore = ":disabled";
			    return form.valid();
			}
			onFinished: {
			       alert("You've successfully submitted this program for approval. You'll be notified of its status soon."); 
			       location.href = 'index.html#pending-approvals';
			} */
  </script>
  <!--  Validation setup Ends -->
			


      
   </head>
   <body>

  <section id="container" class="">
     <!--header start-->
         <header class="header dark-bg">
            <div class="sidebar-toggle-box">
               <i class="fa fa-bars"></i>
            </div>
            <!--logo start-->
            <a href="index.html" class="logo"><img src="resources/img/yokohama-logo.svg" width="132" height="52"></a>
            <!--logo end-->
            <div class="nav notify-row" id="top_menu">
               <!--  notification start -->
               <ul class="nav top-menu">
              <!-- settings start -->
              <!-- settings end -->
             
            <!-- notification dropdown start-->
             <li id="header_notification_bar" class="dropdown">
                  <a data-toggle="dropdown" class="dropdown-toggle" href="#">

                      <i class="fa fa-bell-o"></i>
                      <span class="badge bg-important">7</span>
                  </a>
                  <ul class="dropdown-menu extended notification">
                      <div class="notify-arrow notify-arrow-yellow"></div>
                      <li>
                          <p class="yellow">You have 7 new notifications</p>
                      </li>
                      <li>
                          <a href="#">
                              <span class="label label-success"><i class="fa fa-bell"></i></span>
                              #20543 has been approved
                              <span class="small italic">30 mins</span>
                          </a>
                      </li>
                      <li>
                          <a href="#">
                              <span class="label label-danger"><i class="fa fa-bolt"></i></span>
                               #20543 has been rejected
                              <span class="small italic">4 hrs</span>
                          </a>
                      </li>
                  </ul>
              </li>
              <!-- notification dropdown end -->
          </ul>
            </div>
            <div class="top-nav">
               <ul class="nav pull-right top-menu">
                  <li>
                     <input type="text" class="form-control search" placeholder="Search">
                  </li>
                  <!-- user login dropdown start-->
                  <li class="dropdown">
                     <a data-toggle="dropdown" class="dropdown-toggle" href="#">
                     <!--img alt="" src="resources/img/avatar1_small.jpg"-->
                     <span class="username">John Doe</span>
                     <b class="caret"></b>
                     </a>
                     <ul class="dropdown-menu extended logout">
                        <div class="log-arrow-up"></div>
                        <li><a href="#"><i class=" fa fa-suitcase"></i>Profile</a></li>
                        <li><a href="#"><i class="fa fa-cog"></i> Settings</a></li>
                        <li><a href="#"><i class="fa fa-bell-o"></i> Notification</a></li>
                        <li><a href="login.html"><i class="fa fa-key"></i> Log Out</a></li>
                     </ul>
                  </li>
                  <!-- user login dropdown end -->
               </ul>
            </div>
         </header>
         <!--header end-->
         <!--sidebar start-->
         <aside>
            <div id="sidebar"  class="nav-collapse ">
               <!-- sidebar menu start-->
               <ul class="sidebar-menu" id="nav-accordion">
                  <li>
                     <a class="" href="index.html">
                     <i class="fa fa-dashboard"></i>
                     <span>My Dashboard</span>
                     </a>
                  </li>
                  <li>
                     <a class="" href="program_details.html">
                     <i class="fa fa-tasks"></i>
                     <span>Create New Program</span>
                     </a>
                  </li>
                  <li>
                     <a class="active" href="program_details_existing.html">
                     <i class="fa fa-tasks"></i>
                     <span>Edit Program</span>
                     </a>
                  </li>
                  <li>
                     <a class="" href="program_details_rejected.html">
                     <i class="fa fa-tasks"></i>
                     <span>Edit Rejected Program</span>
                     </a>
                  </li>
                  <li>
                     <a href="login.html">
                     <i class="fa fa-user"></i>
                     <span>Login Page</span>
                     </a>
                  </li>
               </ul>
               <!-- sidebar menu end-->
            </div>
         </aside>
         <!--sidebar end-->
      <!--main content start-->
        <section id="main-content">
          <section class="wrapper">
              <!-- page start-->
              <div class="row">
                  <div class="col-lg-12">
                      <section class="panel">
                          <header class="panel-heading">
                             <h3>Program/Pricing Request</h3>
                          </header>
                          <div class="panel-body">
                              <div class="clearfix">
                             <div class="col-lg-12">
                                <h5 data-original-title="Program Details" data-content="Click on the grey button below to see more info about this program. Click again to hide it." data-placement="top" data-trigger="hover" class="popovers">Program Details</h5>
                                 <ul class="list-inline w-list">
                                    <li>Business Unit: <strong><span class="yokohamared">Commercial</span></strong></li>
                                    <li><button type="button" class="btn btn-default btn-xs" data-toggle="collapse" data-target="#demo"><i class="fa fa-angle-down"></i></button></li>
                                 </ul>
                               <div id="demo" class="collapse out">
                                <div class="col-lg-3 col-sm-4 p-left0">
                                   <ul class="list-unstyled w-list">
                                    <h5>Requested By:</h5>   
                                    <li>Name: Tim Buerman</li>
                                    <li>Title: District Sales Manager</li>
                                    <li>Requested Date: 12/12/2016</li>
                                 </ul>
                                </div>
                               <div class="col-lg-3 col-md-5 col-sm-4">
                                   <ul class="list-unstyled w-list">
                                   <h5>Approved By:</h5>   
                                    <li>Name: Rick Hinds</li>
                                    <li>Title: Zone Manager</li>
                                    <li>Approved Date: 12/12/2016</li>
                                 </ul>
                                </div>
                           </div>
                       </div>
                       </div>
                        <form id="pricingRequest" name="pricingRequest" role="form" class="cmxform">
                            <div class="form-group">
                                    <div class="col-sm-12 inline-flex">
                                             <div class="radio-inline p-left0 m-bot15">
                                                <label class="control-label" for="inputSuccess">
                                                <input type="radio" name="optionsRadiosSourcePathName" id="optionsRadiosGroup" value="Group" class="radio-inline required" >
                                                Group
                                                </label>
                                            </div>
                                        <div class="radio-inline m-bot15">
                                                <label class="control-label" for="inputSuccess">
                                                <input type="radio" name="optionsRadiosSourcePathName" id="optionsRadiosCustByBillTo" value="BillTo" class="radio-inline required" checked="checked">
                                                Customer By BillTo</label> 
                                        </div>
                                        <div class="radio-inline m-bot15">
                                                <label class="control-label" for="inputSuccess">
                                                <input type="radio" name="optionsRadiosSourcePathName" id="optionsRadiosCustByName" value="Name" class="radio-inline required">
                                                Customer By Name</label> 
                                        </div>
                                        <div class="radio-inline m-bot15">
                                                <label class="control-label" for="inputSuccess">
                                                <input type="radio" name="optionsRadiosSourcePathName" id="optionsRadiosShipTo" value="ShipTo" class="radio-inline required">
                                                ShipTo</label> 
                                        </div>
                                    </div>
                                  </div>
                                <div class="form-group clearfix">
                                  <div class="col-sm-5">
                                    <label class="control-label" for="inputSuccess">Customer/Group</label>
                                        <select class="form-control input-sm m-bot15" id="custByName_inputselect" name="custByName_inputselect">
                                           <!--  <option disabled class="" value="">- Select One -</option> -->
                                          <!--   <option id="custByName_inputselect1" value="MILLER TRUCKING LLC" name="custByName_inputselect1">MILLER TRUCKING LLC</option>
                                            <option id="custByName_inputselect2" value="DEALER TIRE" name="custByName_inputselect2">DEALER TIRE LLC</option>
                                            <option id="custByName_inputselect3" value="DISCOUNT TIRE LLC" name="custByName_inputselect3">DISCOUNT TIRE LLC</option> -->
                                        </select>
                                    </div>
                                    <div class="col-sm-2">
                                     <label class="control-label">Cust ID</label>
                                        <input type="text" class="form-control m-bot15" id="customeID" name="customeID" placeholder="customeID">
                                    </div>
                                    <div class="col-sm-5">
                                    <label class="control-label">Cust/Group</label>
                                        <input type="text" class="form-control  m-bot15" id="customerGroup" name="customerGroup" placeholder="customerGroup">
                                    </div>    
                                </div>
                          <div class="adv-table editable-table">
                          <div class="clearfix">
                              <div class="btn-group pull-right">
                                <div class="btn-group">
                                    <a href="#"><button class="btn btn-default" onclick="tableToExcel('testgrid', 'Pricing Details Table')"><i class="fa fa-arrow-down"></i> Export To Excel</button></a>
                                </div>
                              </div>
                              <div class="btn-group pull-left">
                                  <h5 class="p-left16">Invoice Discount</h5>
                              </div>
                          </div>
                          </div>
 
 
 
                              

                              
                          
                          <div class="adv-table editable-table">
                          
							<input type="file" name="xlfile" id="xlf" />
							<br />
							<div id="tablecontent"></div>
							</div>                              
                          
 	<script>
 	
	var xlf = document.getElementById('xlf');
		if(xlf.addEventListener) {
		xlf.addEventListener('change', handleFile, false);
	} 
 	
 	</script>                     

     <script>
        $(function () {

            $("#input").on("change", function () {
                var excelFile,
                    fileReader = new FileReader();

                $("#result").hide();

                fileReader.onload = function (e) {
                    var buffer = new Uint8Array(fileReader.result);

                    $.ig.excel.Workbook.load(buffer, function (workbook) {
                        var column, row, newRow, cellValue, columnIndex, i,
                            worksheet = workbook.worksheets(0),
                            columnsNumber = 0,
                            gridColumns = [],
                            data = [],
                            worksheetRowsCount;

                        // Both the columns and rows in the worksheet are lazily created and because of this most of the time worksheet.columns().count() will return 0
                        // So to get the number of columns we read the values in the first row and count. When value is null we stop counting columns:
                        while (worksheet.rows(0).getCellValue(columnsNumber)) {
                            columnsNumber++;
                        }

                        // Iterating through cells in first row and use the cell text as key and header text for the grid columns
                        for (columnIndex = 0; columnIndex < columnsNumber; columnIndex++) {
                            column = worksheet.rows(0).getCellText(columnIndex);
                            gridColumns.push({ headerText: column, key: column });
                        }

                        // We start iterating from 1, because we already read the first row to build the gridColumns array above
                        // We use each cell value and add it to json array, which will be used as dataSource for the grid
                        for (i = 1, worksheetRowsCount = worksheet.rows().count() ; i < worksheetRowsCount; i++) {
                            newRow = {};
                            row = worksheet.rows(i);

                            for (columnIndex = 0; columnIndex < columnsNumber; columnIndex++) {
                                cellValue = row.getCellText(columnIndex);
                                newRow[gridColumns[columnIndex].key] = cellValue;
                            }

                            data.push(newRow);
                        }

                        // we can also skip passing the gridColumns use autoGenerateColumns = true, or modify the gridColumns array
                        createGrid(data, gridColumns);
// 						createEditableGrid(data, gridColumns);
                    }, function (error) {
                        $("#result").text("The excel file is corrupted.");
                        $("#result").show(1000);
                    });
                }

                if (this.files.length > 0) {
                    excelFile = this.files[0];
                    if (excelFile.type === "application/vnd.ms-excel" || excelFile.type === "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" || (excelFile.type === "" && (excelFile.name.endsWith("xls") || excelFile.name.endsWith("xlsx")))) {
                        fileReader.readAsArrayBuffer(excelFile);
                    } else {
                        $("#result").text("The format of the file you have selected is not supported. Please select a valid Excel file ('.xls, *.xlsx').");
                        $("#result").show(1000);
                    }
                }

            })
        })

        function createGrid(data, gridColumns) {
            if ($("#grid1").data("igGrid") !== undefined) {
                $("#grid1").igGrid("destroy");
            }

            $("#grid1").igGrid({
                columns: gridColumns,
                autoGenerateColumns: true,
                dataSource: data,
                width: "100%"
            });
        }
        



</script>
    
<br/>   
<br/>

    
    
                         
                      
                      
                      
                        <div class="col-sm-6">
                           <label class="control-label" for="inputSuccess">User Comments</label>
                            <textarea class="form-control" id="user_comments" name="user_comments" rel="txtTooltip" data-content="If you can't see all your content, pull down the bottom-right corner of this field to expand the height." title="<i class='fa fa-lightbulb-o'></i>&nbsp;&nbsp;Hot Tip" data-toggle="tooltip" data-placement="top" rows="3" placeholder="Add description details of your customer" value="Dealer has three shops in his county"></textarea>
                        </div>
                        <div class="space15 clearfix"></div>
                            
                <!-- END Invoice Discount Section -->

                <!-- START Program Terms -->
                              
                        <div class="form-group clearfix">
                            <h5 class="p-left16">Program Terms</h5>
                                <div class="col-lg-5 col-md-7 col-sm-5">
                                    <label class="control-label" for="inputSuccess">Terms Code</label>
                                        <select class="form-control input-sm m-bot15" id="termsCode_inputselect" name="termsCode_inputselect">
                                           <!--  <option disabled class="" value="">- Select -</option>
                                            <option id="terms_code_inputselect" value="Standard NA - NT - 5%30/2%60, due 15/25">Standard NA - NT - 5%30/2%60, due 15/25</option>
                                            <option id="terms_code_inputselect1" value="Express N/A - NX - 5% 30 Days,  past due 31, due Calendar days">Express N/A - NX - 5% 30 Days,  past due 31, due Calendar days</option>
                                            <option id="terms_code_inputselect2" value="Consumer Mkt - (3N) - 2% 60 days, due 15/25">Consumer Mkt - (3N) - 2% 60 days, due 15/25 </option>
                                            <option selected id="terms_code_inputselect5" value="Truck Stop" name="3">Truck Stop</option>
                                            <option selected id="terms_code_inputselect6" value="MW - NET 30 DAYS, due Calendar days" name="">MW - NET 30 DAYS, due Calendar days </option>
                                            <option selected id="terms_code_inputselect7" value="NAD Units" name="2c - 2% 30 DAYS, due 15/25">2c - 2% 30 DAYS, due 15/25</option>
                                            <option selected id="terms_code_inputselect8" value="AM - 2% 30 DAYS, due 15/30" name="">AM - 2% 30 DAYS, due 15/30</option>
                                            <option selected id="terms_code_inputselectz" value="2f - 2% 60 DAYS, due 20" name="">2f - 2% 60 DAYS, due 20</option>
                                            <option>D3 - 2% 90 DAYS, due 15/25</option>
                                            <option>WV - 2% 90 DAYS, due 10/20/30</option>
                                            <option>O4 - 5% 30 DAYS, due 15/25</option>
                                            <option>CD - COD TERMS, due Calendar days</option>
                                            <option>JG - NET 60 DAYS, due 10/20/30</option>
                                            <option>I7 - NET 60 DAYS, due 15/25</option>
                                            <option>n7 - NET 60 DAYS, due 20</option>
                                            <option>I8 - NET 90 DAYS, due 15/25</option>
                                            <option>W9 - NET 60  DAYS</option>
                                            <option>n3 - NET 30 DAYS, due 15/25</option>
                                            <option>CX - NET 45 DAYS, due Calendar days</option>
                                            <option>Mf - NET 90 DAYS </option>
                                            <option>9T - 2% 90 DAYS</option>
                                            <option>2w - 2% 90 DAYS</option> -->
                                        </select>
                                    </div>
                                <div class="col-lg-3 col-md-5 col-sm-3">
                                      <label for="businessUnit" class="control-label">Definition</label>
                                      <input type="text" class="form-control" id="program_terms_definition" name="program_terms_definition" placeholder="">
                                </div>
                                <div class="col-lg-2 col-md-6 col-sm-2">
                                      <label for="requestType">Due Dates</label>
                                      <input type="text" class="form-control" id="program_terms_duedates" name="program_terms_duedates" placeholder="">
                                </div>
                                <div class="col-lg-2 col-md-6 col-sm-2">
                                      <label for="requestType">Cash</label>
                                      <input type="text" class="form-control" id="program_terms_cash" name="program_terms_cash" placeholder="">
                                </div>
                    </div>
                 <!-- END Program Terms -->
                            
                 <!-- START Shippng Terms -->
                                <h5 class="p-left16">Shipping Requirements</h5>
                                    <div class="form-group">
                                    <div class="col-lg-5 col-md-8 inline-flex p-left0">
                                        <div class="tooltips" data-placement="top" data-toggle="tooltip" data-original-title="Select which program applies">
                                             <label class="control-label" for="inputSuccess"></label>
                                             <div class="radio-inline">
                                                <label class="control-label" for="inputSuccess">
                                                <input type="radio" name="optionsRadiosShippingProgram" id="optionsRadios1000lbs" value="1000 LBS" class="radio-inline required" checked="checked">
                                                1000 LBS
                                                </label>
                                            </div>
                                        </div>
                                        <div class="radio-inline">
                                                <label class="control-label" for="inputSuccess">
                                                <input type="radio" name="optionsRadiosShippingProgram" id="optionsRadios2000lbs" value="2000 LBS" class="radio-inline required" checked="">
                                                2000 LBS</label> 
                                        </div>
                                        <div class="radio-inline">
                                                <label class="control-label" for="inputSuccess">
                                                <input type="radio" name="optionsRadiosShippingProgram" id="optionsRadiosTrailerLoad" value="Trailer Load" class="radio-inline required">
                                                Trailer Load</label> 
                                        </div>
                                        <div class="radio-inline">
                                                <label class="control-label" for="inputSuccess">
                                                <input type="radio" name="optionsRadiosShippingProgram" id="optionsRadiosPerProgram" value="Per Program" class="radio-inline required">
                                                 Per Program</label> 
                                        </div>
                                    </div>
                                  <div class="col-lg-5 col-sm-12">
                                    <label class="control-label" for="inputSuccess">Other</label>
                                        <select class="form-control input-sm m-bot15" id="Other_Ship_Reqs_inputselect" name="Other_Ship_Reqs_inputselect">
                                           <!--  <option disabled class="" value="">- Other Types of Shipping Programs -</option> -->
                                         <!--    <option id="shipping_other1" value="Additional Per Tire:   $1.00 21,000 lbs, $2.00 30,000 lbs" name="payout_freq_annually">Additional Per Tire:   $1.00 21,000 lbs, $2.00 30,000 lbs</option>
                                            <option id="shipping_other2" value="Semi-Anually" name="shipping_other2">Additional Per Tire:   $1.00 20,000 lbs, $2.00 34,000 lbs</option>
                                            <option id="shipping_other3" value="Additional Per Tire:   $1.00 20,000 lbs, $2.00 32,000 lbs" name="payout_freq_monthly">Additional Per Tire:   $1.00 20,000 lbs, $2.00 32,000 lbs</option> -->
                                        </select>
                                    </div>
                                </div>
                 <!-- END Shippng Terms -->

                  <!---- START Submit for Approval -->
          <div class="clearfix space15"></div>
          <div class="clearfix">
             <a class="btn btn-info finish" id="save-program" href="javascript: validateBeforeSubmit('#myModal1')"><i class="fa fa-save"></i>&nbsp;&nbsp;Save Changes</a>
              <!-- Modal -->
                              <!-- <div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                                  <div class="modal-dialog">
                                      <div class="modal-content">
                                          <div class="modal-header">
                                              <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                                              <h4 class="modal-title">Save Program Changes?</h4>
                                          </div>
                                          <div class="modal-body">
                                              <div class="space15">&nbsp;</div>
If you want to save these changes for later, select 'Save As Draft'. If you want to submit these changes, select "Submit For Approval". If you don't want to save your changes, click the "Cancel" button below and your program will not save these changes.
                                              <div class="space15"></div>
                                          </div>
                                          <div class="modal-footer">
                                              <button data-dismiss="modal" class="btn btn-default" type="button">Cancel</button>
                                              	<a href="javascript: saveDraft()"><button class="btn btn-info" type="button"><i class="fa fa-save"></i>&nbsp;&nbsp;Save As Draft</button></a>
                                              <a href="index.html#pending-approvals"><button class="btn btn-success" type="button"><i class="fa fa-check-circle"></i>&nbsp;&nbsp;Submit For Approval</button></a>
                                          </div>
                                      </div>
                                  </div>
                              </div> -->
                              <div class="modal fade" id="myModal1" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                	<div class="modal-dialog">
                    	<div class="modal-content">
                        	<div class="modal-header">
                            	<button id="program-save-modal-close" type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                                <h4 class="modal-title">Save Program Changes?</h4>
                            </div>
							<div class="modal-body">
								<div class="space15">&nbsp;</div>
								<div class="text-center">Are you sure you want to Save Changes? If you still want to save your changes, click the OK button. If you don't want to save your changes, click the "Cancel" button below and your program will not save these changes. </div>
                                <div class="space15"></div>
							</div>
							<div class="modal-footer">
								<button data-dismiss="modal" class="btn btn-default" id="program-save-modal-cancel"
									type="button">Cancel</button>
								<a href="javascript: saveDraft()"><button class="btn btn-info" id="program-save-modal-ok" type="button">
										<i class="fa fa-save"></i>&nbsp;&nbsp;OK
									</button></a>
							</div>
						</div>
					</div>
				</div>
					
				<div class="modal fade" id="myModal4" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                	<div class="modal-dialog">
                    	<div class="modal-content">
                        	<div class="modal-header">
                            	<button id="program-confirmation-modal-close" type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                                <h4 class="modal-title">Confirmation</h4>
                            </div>
							<div class="modal-body">
								<!-- <div class="space15">&nbsp;</div> -->
								<div class="text-center"> <span id="confirmMessage"></span> </div>
                                <!-- <div class="space15"></div> -->
							</div>
							<div class="modal-footer">
								<button class="btn btn-info" type="button" id="program-confirmation-modal-ok" data-toggle="modal" href="#myModal4">
										<i class="fa fa-save"></i>&nbsp;&nbsp;OK
								</button>
							</div>
						</div>
					</div>
				</div>
				
				<div class="modal fade" id="myModal5" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                	<div class="modal-dialog">
                    	<div class="modal-content">
                        	<div class="modal-header">
                            	<button id="program-confirmation-modal-close" type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                                <h4 class="modal-title">Issue in Saving Data</h4>
                            </div>
							<div class="modal-body">
								<!-- <div class="space15">&nbsp;</div> -->
								<div class="text-center"> <span id="errorMessage"></span> </div>
                                <!-- <div class="space15"></div> -->
							</div>
							<div class="modal-footer">
								<button class="btn btn-info" type="button" id="program-confirmation-modal-ok" data-toggle="modal" href="#myModal5">
										<i class="fa fa-save"></i>&nbsp;&nbsp;OK
								</button>
							</div>
						</div>
					</div>
				</div>
                            </div>
                        </form>
                        </div>
                </section>
            </div>
        </div><!-- END opening ROW -->
  </section>
  </section>
<!--main content end-->

  <!--footer start-->
      <footer class="site-footer">
         <div class="text-center">
            2017 &copy; Yokohama Tire Corporation. All rights reserved. The Yokohama Rubber Company Limited
            <a href="#" class="go-top">
            <i class="fa fa-angle-up"></i>
            </a>
         </div>
      </footer>
<!--footer end-->    
</section>
<!-- END section id="container" FIRST section after opening body tag  -->




  </body>
</html>
