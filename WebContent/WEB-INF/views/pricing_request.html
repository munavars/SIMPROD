<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="Yokohama">
    <meta name="keyword" content="">
	<meta http-equiv='cache-control' content='no-cache'>
	<meta http-equiv='expires' content='0'>
    <meta http-equiv='pragma' content='no-cache'>
    
    <title>Pricing Form</title>

	<!-- Bootstrap core CSS -->
	<link href="resources/css/bootstrap.min.css" rel="stylesheet">
	<link href="resources/css/bootstrap-reset.css" rel="stylesheet">
	
	<!--external css-->
	<link href="resources/assets/font-awesome/css/font-awesome.css" rel="stylesheet" />
	<link rel="stylesheet" type="text/css" href="resources/assets/bootstrap-datepicker/css/datepicker.css" />
	<link rel="stylesheet" type="text/css" href="resources/assets/bootstrap-daterangepicker/daterangepicker-bs3.css" />
	<link rel="stylesheet" type="text/css" href="resources/assets/bootstrap-timepicker/compiled/timepicker.css" />
	<link rel="stylesheet" type="text/css" href="resources/assets/bootstrap-datetimepicker/css/datetimepicker.css" />
	<link rel="stylesheet" type="text/css" href="resources/assets/bootstrap-fileupload/bootstrap-fileupload.css" />
	<link rel="stylesheet" href="resources/assets/data-tables/DT_bootstrap.css" />
	
	<!--bootstrap switcher-->
	<link rel="stylesheet" type="text/css" href="resources/assets/bootstrap-switch/static/stylesheets/bootstrap-switch.css" />
	<!--select 2-->
	<link rel="stylesheet" type="text/css" href="resources/assets/select2/css/select2.min.css"/>
	
	<!-- Custom styles for this template -->
	<link href="resources/css/style.css" rel="stylesheet">
	<link href="resources/css/style-responsive.css" rel="stylesheet" />	
	
	<link rel="stylesheet" href="https://cdn.datatables.net/1.10.4/css/jquery.dataTables.min.css">

    <script type="text/javascript">
       function sync()
       {
         var n1 = document.getElementById('include');
         var n2 = document.getElementById('input4');
         n2.value = n1.value;
       }
        //Export to Excel 
   function tableToExcel(tableId, fileName) {
	    var tab_text="<table border='2px'><tr bgcolor='#87AFC6'>";
	    var textRange; var j=0;
	    tab = document.getElementById(tableId); // id of table
	    fileName=fileName+$("#loginUserName").html()+"_"+new Date().toLocaleString();
		
	    for(j = 0 ; j < tab.rows.length ; j++) 
	    {     
	       var table_cells = tab.rows[j].getElementsByTagName('td'); 
	        
	        for (var i = 0; i < table_cells.length; i++) { 
   			if(i==5)
	   		{
	   		 cell.setAttribute("style", 'mso-number-format:"\@"');
	   		}
	   		}
	   		var text="";
	   		if(j==0)
	   		{
	   		 text=tab.rows[j].innerHTML.replace('<th class="editablegrid-ID" data-title="ID" style="display: none;"><a style="cursor: pointer;">ID</a></th>',"");
	   		}
	   		else
	   		{
	   		  text=tab.rows[j].innerHTML.replace('<td class="editablegrid-ID" data-title="ID" style="display: none;"></td>',"");
	   		}
	   		
	   		tab_text=tab_text+text+"</tr>";
	    }
	    tab_text=tab_text+"</table>";
	    tab_text= tab_text.replace(/<a[^>]*>|<\/a>/g, "");//remove if u want links in your table
	    tab_text= tab_text.replace(/<img[^>]*>/gi,""); // remove if u want images in your table
	    tab_text= tab_text.replace(/<input[^>]*>|<\/input>/gi, ""); // reomves input params
	    if (navigator.userAgent.indexOf('Trident')>0 || navigator.userAgent.indexOf('Edge')>0)
	    {
	    	var blobObject = new Blob([tab_text]); 
	    	window.navigator.msSaveOrOpenBlob(blobObject, fileName+'.xls');
	    }else
	    {
	        var a = document.createElement('a');
	        var data_type = 'data:application/vnd.ms-excel';
		    a.href = data_type + ', ' + encodeURIComponent(tab_text);
			a.download =  fileName+'.xls';
			document.body.appendChild(a);
			a.click();
			document.body.appendChild(a);   
		}
    }
    </script>
      
	<!-- js placed at the end of the document so the pages load faster -->
	<script src="http://code.jquery.com/jquery-1.11.3.min.js"></script>
	<script src="resources/js/bootstrap.min.js"></script>
	<script src="http://code.jquery.com/ui/1.11.1/jquery-ui.min.js"></script>
	<script src="resources/js/jquery-ui-1.9.2.custom.min.js"></script>
	
	<!-- Ignite UI Required Combined JavaScript Files -->
	<!--Form Validation-->
	<script src="resources/js/bootstrap-validator.min.js" type="text/javascript"></script>
	
	<!--Form Wizard-->
	<script src="resources/js/jquery.validate.min.js" type="text/javascript"></script>
	<script src="resources/js/slidebars.min.js"></script>
	<script type="text/javascript" src="resources/assets/bootstrap-datepicker/js/bootstrap-datepicker.js"></script>
	<script type="text/javascript" src="resources/assets/bootstrap-datetimepicker/js/bootstrap-datetimepicker.js"></script>
	<script type="text/javascript" src="resources/assets/bootstrap-daterangepicker/moment.min.js"></script>
	<script type="text/javascript" src="resources/assets/bootstrap-daterangepicker/daterangepicker.js"></script>
	    
	<script type="text/javascript" src="resources/assets/data-tables/jquery.dataTables.js"></script>
	<script type="text/javascript" src="resources/assets/data-tables/DT_bootstrap.js"></script>
<style>
#drop{
	border:2px dashed #bbb;
	-moz-border-radius:5px;
	-webkit-border-radius:5px;
	border-radius:5px;
	padding:25px;
	text-align:center;
	font:20pt bold,"Vollkorn";color:#bbb
}
#b64data{
	width:100%;
}
a { text-decoration: none }
</style>

		<script src="resources/js/editablegrid.js"></script>
		<script src="resources/js/editablegrid_renderers.js" ></script>
		<script src="resources/js/editablegrid_editors.js" ></script>
		<script src="resources/js/editablegrid_validators.js" ></script>
		<script src="resources/js/editablegrid_utils.js" ></script>
		<script src="resources/js/editablegrid_charts.js" ></script>
		<link rel="stylesheet" href="resources/css/editablegrid.css" type="text/css" media="screen">
		
		<style>
			body { font-family:'lucida grande', tahoma, verdana, arial, sans-serif; font-size:11px; }
			h1 { font-size: 15px; }
			a { color: #548dc4; text-decoration: none; }
			a:hover { text-decoration: underline; }
			table.testgrid { border-collapse: collapse; border: 1px solid #CCB; width: 800px; }
			table.testgrid td, table.testgrid th { padding: 5px; border: 1px solid #E0E0E0; }
			table.testgrid th { background: #E5E5E5; text-align: left; }
			input.invalid { background: red; color: #FDFDFD; }
		</style>




<script src="resources/js/cpexcel.js"></script>
<script src="resources/js/shim.js"></script>
<script src="resources/js/jszip.js"></script>
<script src="resources/js/xlsx.js"></script>
<script>
	var fileData ={};
	var dataUploaded = false;
	/*jshint browser:true */
	/*global XLSX */
	var X = XLSX;
	var XW = {
		/* worker message */
		msg: 'xlsx',
		/* worker scripts */
		rABS: './xlsxworker2.js',
		norABS: './xlsxworker1.js',
		noxfer: './xlsxworker.js'
	};
	
	var rABS = typeof FileReader !== "undefined" && typeof FileReader.prototype !== "undefined" && typeof FileReader.prototype.readAsBinaryString !== "undefined";
	if(!rABS) {
		document.getElementsByName("userabs")[0].disabled = true;
		document.getElementsByName("userabs")[0].checked = false;
	}
	
	var use_worker = typeof Worker !== 'undefined';
	if(!use_worker) {
		document.getElementsByName("useworker")[0].disabled = true;
		document.getElementsByName("useworker")[0].checked = false;
	}
	
	var transferable = use_worker;
	if(!transferable) {
		document.getElementsByName("xferable")[0].disabled = true;
		document.getElementsByName("xferable")[0].checked = false;
	}
	
	var wtf_mode = false;
	
	function to_csv(workbook) {
		var result = [];
		workbook.SheetNames.forEach(function(sheetName) {
			var csv = X.utils.sheet_to_csv(workbook.Sheets[sheetName]);
			if(csv.length > 0){
				result.push(sheetName);
				result.push("");
				result.push(csv);
			}
		});
		return result.join("\n");
	}
	
	function fixdata(data) {
		var o = "", l = 0, w = 10240;
		for(; l<data.byteLength/w; ++l) o+=String.fromCharCode.apply(null,new Uint8Array(data.slice(l*w,l*w+w)));
		o+=String.fromCharCode.apply(null, new Uint8Array(data.slice(l*w)));
		return o;
	}
	
	function to_json(workbook) {
		var result = {};
		workbook.SheetNames.forEach(function(sheetName) {
			var roa = X.utils.sheet_to_row_object_array(workbook.Sheets[sheetName]);
			if(roa.length > 0){
				result[sheetName] = roa;
			}
		});
		return result;
	}
	
	var global_wb;
	function process_wb(wb) {
		global_wb = wb;
		
		var output = "";
		
		output = to_csv(wb);
		buildTable(output);
	}
	
	function removeCommaBetweenDoubleQuote(aString) {
		var result = aString
		// find first occurance of "
		var iStart = aString.indexOf('"');
		var iEnd = iStart + 1;
		if (iStart >= 0) {
			// find ending quote "
			iEnd = aString.indexOf('"', iEnd);
			if (iEnd > 0) {
				var value = aString.substring(iStart+1, iEnd);
				// alert("Before value "+value);
				var i = value.indexOf(',');
				if (i > 0) {
					//value.replace(',', '');
					value = value.substring(0,i) + value.substring(i+1);
				}
				// alert("After value "+value);
				result = aString.substring(0, iStart) + value + aString.substring(iEnd+1);
			}
		}
		return result;
	}
	
	function buildTable(output) {
		var rows = output.split('\n');
		var rowData = [];
		var title = rows[0];
		var data = [];
		var columnNames = [];
		var isValid = true;
		// this approach is interesting if you need to dynamically create data in Javascript 
			var metadata = [];
		// heading built successfully.  rows[0] = wd sheet name, rows[1] = blank space
		for (var j = 0; j < rows.length; ++j) {
			if (rows[j].length > 0) {
				// alert("Before "+rows[j]);
				rows[j] = removeCommaBetweenDoubleQuote(rows[j]);
				// alert("After "+rows[j]);
				var oneRow = rows[j].split(",");
				if (rows[j].length > 0) {
					if (j == 2 ) {
						columnNames = oneRow;
						for (var k = 0; k < columnNames.length; ++k) {
							metadata.push({ name: columnNames[k], label: columnNames[k], datatype: "string", editable: false});
							// alert("metadata: "+k+" "+columnNames[k]);
						}
						metadata.push({ name: 'ID', label: 'ID', datatype: "string", editable: false, hidden: true});
					} else {
						if (j > 2) {
						// data.push({ name: oneRow[i], label: oneRow[i], datatype: "string", editable: true});
						
							var display2 = {};
							var rowValues = {};
							// id: 1
							var icount = j - 2;
							display2["id"] = icount;
							for (var i = 0; i < columnNames.length; ++i) {
								if(columnNames[i] == "NET PRICE"){
									rowValues[columnNames[i]] = convertAmountFormat(oneRow[i]);
								}
								else if (columnNames[i] == "BEG DATE" || columnNames[i] == "END DATE"){
									if(oneRow[i] != null){
										rowValues[columnNames[i]] =	$.datepicker.formatDate( "mm/dd/yy", new Date(oneRow[i]));
									}
									else{
										rowValues[columnNames[i]] = oneRow[i];
									}
								}
								else{
									 if ((oneRow[i] == null || oneRow[i] == '') && (columnNames[i] == "PROD LINE" || columnNames[i] == "TREAD" || columnNames[i] == " PART#") ){
									 	isValid = false;
									 }

									rowValues[columnNames[i]] = oneRow[i];
								}
							}
							display2["values"] = rowValues;
		
							var myData = JSON.stringify(rowValues);
							// alert(myData);
							data.push({id: icount, values: rowValues});
						}
					}
				}
			}
		}
		
		if(isValid){
			editableGrid = new EditableGrid(title, {
				modelChanged: function(rowId, colId, oldValue, newValue, row) {
					data[rowId].values[columnNames[colId]] = newValue;
				}
			});
			editableGrid.load({"metadata": metadata, "data": data});
			editableGrid.renderGrid("tablecontent", "testgrid","testgrid");
			fileData = data;
			dataUploaded = true;
		}
		else{
			$("#errorMessageModal").html("Prod Line, Tread and Part Number columns cannot have null values.");
			$('#myModal6').modal('toggle');
		}

	} 
	
	EditableGrid.prototype.addCellValidator = function(columnIndexOrName, cellValidator)
	{
		var columnIndex = this.getColumnIndex(2);
		if (columnIndex < 0) alert("[addCellValidator] Invalid column: " + columnIndexOrName);
		else this.columns[columnIndex].cellValidators.push(cellValidator);
	};
	
	function handleFile(e) {
		rABS = false;
		use_worker = false;
	 
		var files = e.target.files;
		var f = files[0];
		{
			var reader = new FileReader();
			var name = f.name;
			reader.onload = function(e) {
				if(typeof console !== 'undefined') console.log("onload", new Date(), rABS, use_worker);
				var data = e.target.result;
				if(use_worker) {
					xw(data, process_wb);
				} else {
					var wb;
					if(rABS) {
						wb = X.read(data, {type: 'binary'});
					} else {
						var arr = fixdata(data);
						wb = X.read(btoa(arr), {type: 'base64'});
					}
					process_wb(wb);
				}
			};
			if(rABS) reader.readAsBinaryString(f);
			else reader.readAsArrayBuffer(f);
		}
	}
</script>
<!-- 
<script type="text/javascript">
	var _gaq = _gaq || [];
	_gaq.push(['_setAccount', 'UA-36810333-1']);
	_gaq.push(['_trackPageview']);

	(function() {
		var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
		ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
		var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
	})();
</script>
 -->



<script type="text/javascript">
	function closeSidebar() {
		if ($('#sidebar > ul').is(":visible") === true) {
			$('#main-content').css({
				'margin-left' : '0px'
			});
			$('#sidebar').css({
				'margin-left' : '-210px'
			});
			$('#sidebar > ul').hide();
			$("#container").addClass("sidebar-closed");
		}
		$('#sidebar-toggle-box').css({
			'display' : 'none'
		});
	}
	
	 function openSidebar() {
	        $('#main-content').css({
	            'margin-left': '210px'
	        });
	        $('#sidebar > ul').show();
	        $('#sidebar').css({
	            'margin-left': '0'
	        });
	        $("#container").removeClass("sidebar-closed");
	        $('#sidebar-toggle-box').css({
	            'display': 'block'
	        });
	    }
</script>

<!-- Inline javascript to set the user name from model attribute Begin -->
<script type="text/javascript" th:inline="javascript">
	$(document).ready(function() {
				
	   var modelAttributeValue = [[${loginUserNameValue}]];
	   $("#loginUserName").html(modelAttributeValue);
	   var emp = [[${EmployeeInfo}]];
	   if(2!=emp[0].ROLE_ID)
	   	{
	   		openSidebar();
		}
/* 	   var url="/SIM/getEmployeeDetail/"+emp[0].MANAGER_ID;
    	$.ajax({ 
        	type: "GET",
        	dataType: "json",
       	url: url,
       	async: false,
        	success: function(response){
        		console.log(response);
        		
        		 $("#requestedBy").html("Name: "+modelAttributeValue);
				   $("#requestedTitle").html("Title: "+emp[0].TITLE_ID);
				   $("#approvedBy").html("Name: "+response.first_NAME+" "+response.last_NAME);
				   $("#approvedTitle").html("Title: "+response.title.title);
				   
        	},
        	failure: function(response){
        		alert("Wrongly done");
        	}
    	}); */
	   
	});
</script>
<!-- Inline javascript to set the user name from model attribute End -->

      
   </head>
   <body>

  <section id="container" class="sidebar-closed">
     <!--header start-->
         <header class="header dark-bg">
            <div class="sidebar-toggle-box" id="sidebar-toggle-box" style="display:none">
               <i class="fa fa-bars"></i>
            </div>
            <!--logo start-->
            <a href="index.html" class="logo"><img src="resources/img/yokohama-logo.svg" width="132" height="52"></a>
            <!--logo end-->
            <div class="nav notify-row" id="top_menu">
               <!--  notification start -->
               <ul class="nav top-menu">
              <!-- settings start -->
              <!-- settings end -->
             
            <!-- notification dropdown start-->
             <!-- <li id="header_notification_bar" class="dropdown">
                  <a data-toggle="dropdown" class="dropdown-toggle" href="#">

                      <i class="fa fa-bell-o"></i>
                      <span class="badge bg-important">7</span>
                  </a>
                  <ul class="dropdown-menu extended notification">
                      <div class="notify-arrow notify-arrow-yellow"></div>
                      <li>
                          <p class="yellow">You have 7 new notifications</p>
                      </li>
                      <li>
                          <a href="#">
                              <span class="label label-success"><i class="fa fa-bell"></i></span>
                              #20543 has been approved
                              <span class="small italic">30 mins</span>
                          </a>
                      </li>
                      <li>
                          <a href="#">
                              <span class="label label-danger"><i class="fa fa-bolt"></i></span>
                               #20543 has been rejected
                              <span class="small italic">4 hrs</span>
                          </a>
                      </li>
                  </ul>
              </li> -->
              <!-- notification dropdown end -->
          </ul>
            </div>
            <div class="top-nav">
               <ul class="nav pull-right top-menu">
                  <!-- <li>
                     <input type="text" class="form-control search" placeholder="Search">
                  </li> -->
                  <!-- user login dropdown start-->
                  <li class="dropdown">
                    <a data-toggle="dropdown" class="dropdown-toggle" href="#">
                     <span class="username" id="loginUserName"></span>
                     
                     <b class="caret"></b>
                     </a>
                     <ul class="dropdown-menu extended logout">
                        <div class="log-arrow-up"></div>
                        <li><a id="logout-btn" href="/SIM/logout"><i class="fa fa-key"></i> Log Out</a></li>
                     </ul>
                  </li>
                  <!-- user login dropdown end -->
               </ul>
            </div>
         </header>
         <!--header end-->
         <!--sidebar start-->
         <aside>
            <div id="sidebar"  class="nav-collapse ">
               <!-- sidebar menu start-->
               <ul class="sidebar-menu" id="nav-accordion">
                  <li>
                     <a class="" href="index.html">
                     <i class="fa fa-dashboard"></i>
                     <span>My Dashboard</span>
                     </a>
                  </li>
                  <li>
                     <a class="" href="program_details.html">
                     <i class="fa fa-tasks"></i>
                     <span>Create New Program</span>
                     </a>
                  </li>
                  <li>
                     <a class="active" href="program_details_existing.html">
                     <i class="fa fa-tasks"></i>
                     <span>Edit Program</span>
                     </a>
                  </li>
                  <li>
                     <a class="" href="program_details_rejected.html">
                     <i class="fa fa-tasks"></i>
                     <span>Edit Rejected Program</span>
                     </a>
                  </li>
                  <li>
                     <a href="login.html">
                     <i class="fa fa-user"></i>
                     <span>Login Page</span>
                     </a>
                  </li>
               </ul>
               <!-- sidebar menu end-->
            </div>
         </aside>
         <!--sidebar end-->
      <!--main content start-->
        <section id="main-content">
          <section class="wrapper">
              <!-- page start-->
              <div id="pricing-parent-div" class="row">
                  <div class="col-lg-12">
                      <section class="panel">
                          <header class="panel-heading">
                             <h3>Program/Pricing Request</h3>
                          </header>
                          <div class="panel-body">
                              <div class="clearfix">
                             <div class="col-lg-12">
                                <h5 data-original-title="Program Details" data-content="Click on the grey button below to see more info about this Program/Pricing. Click again to hide it." data-placement="top" data-trigger="hover" class="popovers">Program Details</h5>
                                
                                <div id="header-button" class="modal-footer" hidden="true">
	                                <!-- EDIT BUTTON START -->
	                                <a class="btn btn-info finish" id="edit-button" data-toggle="modal" href="#myModalEdit" disabled="disabled"><i class="fa fa-edit"></i>&nbsp;&nbsp;Edit</a>
                                </div>
                                <!-- Modal -->
				                <div class="modal fade" id="myModalEdit" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
				                	<div class="modal-dialog">
				                		<div class="modal-content">
				                        	<div class="modal-header">
				                            	<button id="modal-edit-close" type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
				                               	<h4 class="modal-title">Edit confirmation</h4>
				                            </div>
				                            <div class="modal-body">
												<div class="space15">&nbsp;</div>
												 <div class="text-center"> Are you sure you want to Edit? If you still want to Edit, click the OK button. If you don't want to Edit, click the "Cancel" button below and your program will not be editable. </div>
				                                <div class="space15"></div>
				                            </div>
				                            <div class="modal-footer">
				                                    <button id="modal-edit-cancel" data-dismiss="modal" class="btn btn-default" type="button">Cancel</button>
													<a href="javascript: enableFields()"><button id="modal-edit-ok" class="btn btn-info" type="button"><i class="fa fa-edit"></i>&nbsp;&nbsp;OK</button></a>
				                            </div>
										</div>
									</div>
								</div>
								<!-- EDIT BUTTON END -->
                                 <ul class="list-inline w-list">
                                    <li>Business Unit: <strong><span class="yokohamared" id="businessUnitDescription"></span></strong></li>
                                    <li><button id="pricing-expand" type="button" class="btn btn-default btn-xs" data-toggle="collapse" data-target="#demo"><i class="fa fa-angle-down"></i></button></li>
                                 </ul>
                               <div id="demo" class="collapse out">
                                <div class="col-lg-3 col-sm-4 p-left0">
									<ul class="list-unstyled w-list">
										<h5>Requested By:</h5>
										<li><strong>Name:</strong> <span id="requestedBy"></span></li>
										<li><strong>Title:</strong> <span id="requestedTitle"></span></li>
										<li><strong>Requested Date:</strong> <span
											id="requestedDate"></span></li>
									</ul>
								</div>
                               <div class="col-lg-3 col-md-5 col-sm-4">
                                   <ul class="list-unstyled w-list">
	                                   <h5>Approver Details</h5>   
	                                   <!-- <li><strong>Name:</strong> <span id="approvedBy"></span></li>
	                                   <li><strong>Title:</strong> <span id="approvedTitle"></span></li>
	                                   <li><strong>Approved Date:</strong> <span id="approvedDate"></span></li> -->
										<li><strong>Status:</strong> <span id="status"></span>
											<a id="view-program-workflow" data-toggle="modal"
											href="#myModal9">
												<button id="pricing-workflow-btn" type="button"
													class="btn btn-default btn-xs">
													<i class="fa fa-list-alt" aria-hidden="true"></i>
												</button>
										</a></li>

									</ul>
                                </div>
                           </div>
                       </div>
                       </div>
                        <form id="pricingRequest" name="pricingRequest" role="form" class="cmxform">
                            <div class="form-group">
                                    <div class="col-sm-12 inline-flex">
                                             <div class="radio-inline p-left0 m-bot15">
                                                <label class="control-label" for="inputSuccess">
                                                <input type="radio" name="optionsRadiosSourcePathName" id="optionsRadiosGroup" value="Group" class="radio-inline required" >
                                                Group
                                                </label>
                                            </div>
                                        <div class="radio-inline m-bot15">
                                                <label class="control-label" for="inputSuccess">
                                                <input type="radio" name="optionsRadiosSourcePathName" id="optionsRadiosCustByBillTo" value="BillTo" class="radio-inline required" checked="checked">
                                                Customer By BillTo</label> 
                                        </div>
                                        <div class="radio-inline m-bot15">
                                                <label class="control-label" for="inputSuccess">
                                                <input type="radio" name="optionsRadiosSourcePathName" id="optionsRadiosCustByName" value="Name" class="radio-inline required">
                                                Customer By Name</label> 
                                        </div>
                                        <div class="radio-inline m-bot15">
                                                <label class="control-label" for="inputSuccess">
                                                <input type="radio" name="optionsRadiosSourcePathName" id="optionsRadiosShipTo" value="ShipTo" class="radio-inline required">
                                                ShipTo</label> 
                                        </div>
                                    </div>
                                  </div>
                                <div class="form-group clearfix">
                                  <div class="col-sm-5">
                                    <label class="control-label" for="inputSuccess">Customer/Group</label>
                                        <select class="form-control input-sm m-bot15" id="custByName_inputselect" name="custByName_inputselect">
                                           <!--  <option disabled class="" value="">- Select One -</option> -->
                                          <!--   <option id="custByName_inputselect1" value="MILLER TRUCKING LLC" name="custByName_inputselect1">MILLER TRUCKING LLC</option>
                                            <option id="custByName_inputselect2" value="DEALER TIRE" name="custByName_inputselect2">DEALER TIRE LLC</option>
                                            <option id="custByName_inputselect3" value="DISCOUNT TIRE LLC" name="custByName_inputselect3">DISCOUNT TIRE LLC</option> -->
                                        </select>
                                    </div>
                                    <div class="col-sm-2">
                                     <label class="control-label">Cust ID</label>
                                        <input type="text" class="form-control m-bot15" id="customerId" name="customerId" placeholder="Customer Id" readOnly="readonly">
                                    </div>
                                    <div class="col-sm-5">
                                    <label class="control-label">Cust/Group</label>
                                        <input type="text" class="form-control  m-bot15" id="customerGroup" name="customerGroup" placeholder="Customer Group" readonly="readonly">
                                    </div>    
                                </div>
                          <div class="adv-table editable-table">
                          <div class="clearfix">
                              <div class="btn-group pull-right">
                                <div class="btn-group">
                                    <button type="button" id="invoice-export-btn" class="btn btn-default" onclick="tableToExcel('testgrid', 'Pricing Details_')"><i class="fa fa-arrow-down"></i> Export To Excel</button>
                                </div>
                              </div>
                              <div class="btn-group pull-left">
                                  <h5 class="p-left16">Invoice Discount</h5>
                              </div>
                          </div>
                          </div>
                          
                          <div class="adv-table editable-table p-left16">
                          
							<input type="file" name="xlfile" id="xlf" />
							<br />
							<div id="tablecontent"></div>
							</div>                              
                          
 	<script>
 	
	var xlf = document.getElementById('xlf');
		if(xlf.addEventListener) {
		xlf.addEventListener('change', handleFile, false);
	} 
 	
 	</script>

									<script>
        $(function () {

            $("#input").on("change", function () {
                var excelFile,
                    fileReader = new FileReader();

                $("#result").hide();

                fileReader.onload = function (e) {
                    var buffer = new Uint8Array(fileReader.result);

                    $.ig.excel.Workbook.load(buffer, function (workbook) {
                        var column, row, newRow, cellValue, columnIndex, i,
                            worksheet = workbook.worksheets(0),
                            columnsNumber = 0,
                            gridColumns = [],
                            data = [],
                            worksheetRowsCount;

                        // Both the columns and rows in the worksheet are lazily created and because of this most of the time worksheet.columns().count() will return 0
                        // So to get the number of columns we read the values in the first row and count. When value is null we stop counting columns:
                        while (worksheet.rows(0).getCellValue(columnsNumber)) {
                            columnsNumber++;
                        }

                        // Iterating through cells in first row and use the cell text as key and header text for the grid columns
                        for (columnIndex = 0; columnIndex < columnsNumber; columnIndex++) {
                            column = worksheet.rows(0).getCellText(columnIndex);
                            gridColumns.push({ headerText: column, key: column });
                        }

                        // We start iterating from 1, because we already read the first row to build the gridColumns array above
                        // We use each cell value and add it to json array, which will be used as dataSource for the grid
                        for (i = 1, worksheetRowsCount = worksheet.rows().count() ; i < worksheetRowsCount; i++) {
                            newRow = {};
                            row = worksheet.rows(i);

                            for (columnIndex = 0; columnIndex < columnsNumber; columnIndex++) {
                                cellValue = row.getCellText(columnIndex);
                                newRow[gridColumns[columnIndex].key] = cellValue;
                            }

                            data.push(newRow);
                        }

                        // we can also skip passing the gridColumns use autoGenerateColumns = true, or modify the gridColumns array
                        createGrid(data, gridColumns);
// 						createEditableGrid(data, gridColumns);
                    }, function (error) {
                        $("#result").text("The excel file is corrupted.");
                        $("#result").show(1000);
                    });
                }

                if (this.files.length > 0) {
                    excelFile = this.files[0];
                    if (excelFile.type === "application/vnd.ms-excel" || excelFile.type === "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" || (excelFile.type === "" && (excelFile.name.endsWith("xls") || excelFile.name.endsWith("xlsx")))) {
                        fileReader.readAsArrayBuffer(excelFile);
                    } else {
                        $("#result").text("The format of the file you have selected is not supported. Please select a valid Excel file ('.xls, *.xlsx').");
                        $("#result").show(1000);
                    }
                }

            })
        })

        function createGrid(data, gridColumns) {
            if ($("#grid1").data("igGrid") !== undefined) {
                $("#grid1").igGrid("destroy");
            }

            $("#grid1").igGrid({
                columns: gridColumns,
                autoGenerateColumns: true,
                dataSource: data,
                width: "100%"
            });
        }
      
</script>

									<br /> <br />

									<div class="col-sm-6">
										<label class="control-label" for="user_comments">User
											Comments</label>
										<textarea id="user_comments" name="user_comments" 
													class="form-control" rel="txtTooltip"
													data-content="If you can't see all your content, pull down the bottom-right corner of this field to expand the height."
													title="<i class='fa fa-lightbulb-o'></i>&nbsp;&nbsp;Hot Tip"
													data-toggle="tooltip" data-trigger="hover"
													data-placement="top" rows="3"
													placeholder="Add description details"></textarea>
									</div>
																
									<div class="space15 clearfix"></div>
                            
                <!-- END Invoice Discount Section -->

                <!-- START Program Terms -->
                              
                        <div class="form-group clearfix">
                            <h5 class="p-left16">Program Terms</h5>
                                <div class="col-lg-5 col-md-7 col-sm-5">
                                    <label class="control-label" for="inputSuccess">Terms Code</label>
                                        <select class="form-control input-sm m-bot15" id="termsCode_inputselect" name="termsCode_inputselect">
                                        </select>
                                    </div>
                                <div class="col-lg-3 col-md-5 col-sm-3">
                                      <label for="businessUnit" class="control-label">Definition</label>
                                      <input type="text" class="form-control" id="program_terms_definition" name="program_terms_definition" readonly="readonly">
                                </div>
                                <div class="col-lg-2 col-md-6 col-sm-2">
                                      <label for="requestType">Due Dates</label>
                                      <input type="text" class="form-control" id="program_terms_duedates" name="program_terms_duedates" readonly="readonly">
                                </div>
                                <div class="col-lg-2 col-md-6 col-sm-2">
                                      <label for="requestType">Cash</label>
                                      <input type="text" class="form-control" id="program_terms_cash" name="program_terms_cash" readonly="readonly">
                                </div>
                    </div>
                 <!-- END Program Terms -->
                            
                 <!-- START Shippng Terms -->
                                <h5 class="p-left16">Shipping Requirements</h5>
                                    <div class="form-group">
                                    <div class="col-lg-5 col-md-8 inline-flex p-left0">
                                        <div class="tooltips" data-placement="top" data-toggle="tooltip" data-original-title="Select which program applies">
                                             <label class="control-label" for="inputSuccess"></label>
                                             <div class="radio-inline">
                                                <label class="control-label" for="inputSuccess">
                                                <input type="radio" name="optionsRadiosShippingProgram" id="optionsRadios1000lbs" value="1000 LBS" class="radio-inline required" checked="checked">
                                                1000 LBS
                                                </label>
                                            </div>
                                        </div>
                                        <div class="radio-inline">
                                                <label class="control-label" for="inputSuccess">
                                                <input type="radio" name="optionsRadiosShippingProgram" id="optionsRadios2000lbs" value="2000 LBS" class="radio-inline required" checked="">
                                                2000 LBS</label> 
                                        </div>
                                        <div class="radio-inline">
                                                <label class="control-label" for="inputSuccess">
                                                <input type="radio" name="optionsRadiosShippingProgram" id="optionsRadiosTrailerLoad" value="Trailer Load" class="radio-inline required">
                                                Trailer Load</label> 
                                        </div>
                                        <div class="radio-inline">
                                                <label class="control-label" for="inputSuccess">
                                                <input type="radio" name="optionsRadiosShippingProgram" id="optionsRadiosPerProgram" value="Per Program" class="radio-inline required">
                                                 Per Program</label> 
                                        </div>
                                    </div>
                                  <div class="col-lg-5 col-sm-12">
                                    <label class="control-label" for="inputSuccess">Other</label>
                                        <select class="form-control input-sm m-bot15" id="Other_Ship_Reqs_inputselect" name="Other_Ship_Reqs_inputselect">
                                        </select>
                                    </div>
                                </div>
                 <!-- END Shippng Terms -->

                  <!---- START Submit for Approval -->
          <div class="clearfix space15"></div>
          <div class="clearfix"> </div>
									<div id="footer-button" class="modal-footer">
										<button id="cancel-pricing" data-dismiss="modal"
												class="btn btn-default" type="button" onclick="cancelClick('#myModal11')">Cancel</button>
										&nbsp; <a class="btn btn-success" id="submit-pricing"
											href="javascript: validateBeforeSubmit('#myModal')"> <i
											class="fa fa-check-circle"></i>&nbsp;&nbsp;Submit For
											Approval
										</a>&nbsp; <a class="btn btn-info finish" id="save-pricing"
											href="javascript: validateBeforeSubmit('#myModal1')"><i
											class="fa fa-save"></i>&nbsp;&nbsp;Save Changes</a>
										<a
											class="btn btn-info" id="reject-pricing"
											data-toggle="modal" href="#myModal8"><i
											class="fa fa-times-circle"></i>&nbsp;&nbsp;Reject 
										</a> &nbsp;
										<a class="btn btn-success finish" id="approve-pricing"
											data-toggle="modal" href="#myModal7"><i
											class="fa fa-check-circle"></i>&nbsp;&nbsp;Approve
										</a>
										<!-- Modal -->

										<div class="modal fade" id="myModal" tabindex="-1"
											role="dialog" aria-labelledby="myModalLabel"
											aria-hidden="true">
											<div class="modal-dialog">
												<div class="modal-content">
													<div class="modal-header">
														<button id="program-submit-modal-close" type="button"
															class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
														<h4 class="modal-title">Submit for Approval?</h4>
													</div>
													<div class="modal-body">
														<div class="space15">&nbsp;</div>
														<div class="text-center">Are you sure you want to
															Submit for approval? If you still want to submit for
															approval, click the OK button. If you don't want to
															submit, click the "Cancel" button below and your program
															will not be submitted.</div>
														<div class="space15"></div>
													</div>
													<div class="modal-footer">
														<button id="program-submit-modal-cancel"
															data-dismiss="modal" class="btn btn-default"
															type="button">Cancel</button>
														<a href="javascript: submitForApproval()"><button
																id="program-submit-modal-ok" class="btn btn-info"
																type="button">
																<i class="fa fa-save"></i>&nbsp;&nbsp;OK
															</button></a>
													</div>
												</div>
											</div>
										</div>

										<div class="modal fade" id="myModal1" tabindex="-1"
											role="dialog" aria-labelledby="myModalLabel"
											aria-hidden="true">
											<div class="modal-dialog">
												<div class="modal-content">
													<div class="modal-header">
														<button id="program-save-modal-close" type="button"
															class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
														<h4 class="modal-title">Save Program Changes?</h4>
													</div>
													<div class="modal-body">
														<div class="space15">&nbsp;</div>
														<div class="text-center">Are you sure you want to
															Save Changes? If you still want to save your changes,
															click the OK button. If you don't want to save your
															changes, click the "Cancel" button below and your program
															will not save these changes.</div>
														<div class="space15"></div>
													</div>
													<div class="modal-footer">
														<button data-dismiss="modal" class="btn btn-default"
															id="program-save-modal-cancel" type="button">Cancel</button>
														<a href="javascript: saveDraft()"><button
																class="btn btn-info" id="program-save-modal-ok"
																type="button">
																<i class="fa fa-save"></i>&nbsp;&nbsp;OK
															</button></a>
													</div>
												</div>
											</div>
										</div>

										<div class="modal fade" id="myModal4" tabindex="-1"
											role="dialog" aria-labelledby="myModalLabel"
											aria-hidden="true">
											<div class="modal-dialog">
												<div class="modal-content">
													<div class="modal-header">
														<button id="program-confirmation-modal-close"
															type="button" class="close" data-dismiss="modal"
															aria-hidden="true">&times;</button>
														<h4 class="modal-title">Confirmation</h4>
													</div>
													<div class="modal-body">
														<!-- <div class="space15">&nbsp;</div> -->
														<div class="text-center">
															<span id="confirmMessage"></span>
														</div>
														<!-- <div class="space15"></div> -->
													</div>
													<div class="modal-footer">
														<button class="btn btn-info" type="button"
															id="program-confirmation-modal-ok" data-toggle="modal"
															href="#myModal4">
															<i class="fa fa-save"></i>&nbsp;&nbsp;OK
														</button>
													</div>
												</div>
											</div>
										</div>

										<div class="modal fade" id="myModal5" tabindex="-1"
											role="dialog" aria-labelledby="myModalLabel"
											aria-hidden="true">
											<div class="modal-dialog">
												<div class="modal-content">
													<div class="modal-header">
														<button id="program-confirmation-modal-close"
															type="button" class="close" data-dismiss="modal"
															aria-hidden="true">&times;</button>
														<h4 class="modal-title">Issue in Saving Data</h4>
													</div>
													<div class="modal-body">
														<!-- <div class="space15">&nbsp;</div> -->
														<div class="text-center">
															<span id="errorMessage"></span>
														</div>
														<!-- <div class="space15"></div> -->
													</div>
													<div class="modal-footer">
														<button class="btn btn-info" type="button"
															id="program-confirmation-modal-ok" data-toggle="modal"
															href="#myModal5">
															<i class="fa fa-save"></i>&nbsp;&nbsp;OK
														</button>
													</div>
												</div>
											</div>
										</div>
										<div class="modal fade" id="myModal6" tabindex="-1"
											role="dialog" aria-labelledby="myModalLabel"
											aria-hidden="true">
											<div class="modal-dialog">
												<div class="modal-content">
													<div class="modal-header">
														<button id="program-confirmation-modal-close"
															type="button" class="close" data-dismiss="modal"
															aria-hidden="true">&times;</button>
														<h4 class="modal-title">Incorrect Data</h4>
													</div>
													<div class="modal-body">
														<!-- <div class="space15">&nbsp;</div> -->
														<div class="text-center">
															<span id="errorMessageModal"></span>
														</div>
														<!-- <div class="space15"></div> -->
													</div>
													<div class="modal-footer">
														<button class="btn btn-info" type="button"
															id="program-confirmation-modal-ok" data-toggle="modal"
															href="#myModal6">
															<i class="fa fa-save"></i>&nbsp;&nbsp;OK
														</button>
													</div>
												</div>
											</div>
										</div>
										<div class="modal fade" id="myModal7" tabindex="-1"
											role="dialog" aria-labelledby="myModalLabel"
											aria-hidden="true">
											<div class="modal-dialog">
												<div class="modal-content">
													<div class="modal-header">
														<button id="program-comment-modal-close" type="button"
															class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
														<h4 class="modal-title">Confirmation</h4>
													</div>
													<div class="modal-body">
														<div class="row">
															<div class="col-lg-12">
																<div class="text-left">
																	<label class="control-label;text-align: center;"
																		for="approveComments">Please enter
																		comments: </label>
																</div>
																<textarea maxlength="2000" id="approveComments"
																	name="approveComments" class="form-control"></textarea>
															</div>
														</div>
													</div>
													<div class="modal-footer">
														<button data-dismiss="modal" class="btn btn-default"
															id="program-comment-modal-cancel" type="button">Cancel</button>
														<a href="javascript: approveProgram()"><button
																class="btn btn-info" type="button"
																id="program-comment-modal-ok">
																<i class="fa fa-save"></i>&nbsp;&nbsp;OK
															</button> </a>
													</div>
												</div>
											</div>
										</div>

										<div class="modal fade" id="myModal8" tabindex="-1"
											role="dialog" aria-labelledby="myModalLabel"
											aria-hidden="true">
											<div class="modal-dialog">
												<div class="modal-content">
													<div class="modal-header">
														<button id="program-rej-comment-modal-close"
															type="button" class="close" data-dismiss="modal"
															aria-hidden="true">&times;</button>
														<h4 class="modal-title">Confirmation</h4>
													</div>
													<div class="modal-body">
														<div class="row">
															<div class="col-lg-12">
																<div class="text-left">
																	<label class="control-label;text-align: center;"
																		for="rejectionComments">Please enter
																		comments: </label>
																</div>
																<textarea maxlength="2000" id="rejectionComments"
																	name="rejectionComments" class="form-control"></textarea>
															</div>
														</div>
													</div>
													<div class="modal-footer">
														<button data-dismiss="modal" class="btn btn-default"
															id="program-rej-comment-modal-cancel" type="button">Cancel</button>
														<a href="javascript: rejectProgram()"><button
																class="btn btn-info" type="button"
																id="program-rej-comment-modal-ok">
																<i class="fa fa-save"></i>&nbsp;&nbsp;OK
															</button> </a>
													</div>
												</div>
											</div>
										</div>
										<div class="modal fade" id="myModal9" tabindex="-1"
											role="dialog" aria-labelledby="myModalLabel"
											aria-hidden="true">
											<div class="modal-dialog">
												<div class="modal-content">
													<div class="modal-header">
														<button id="program-workflow-close" type="button"
															class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
														<h4 class="modal-title">Workflow status</h4>
													</div>
													<div class="modal-body">
														<div class="read_only">
															<table
																class="table table-striped table-hover table-bordered"
																id="workflow-status-table">
																<thead>
																	<tr class="rowvis" style="background-color: #cacbce;">
																		<th class="text-center">Approver Name</th>
																		<th class="text-center">Approver Role</th>
																		<th class="text-center">Action</th>
																		<th class="text-center">Date</th>
																	</tr>
																</thead>
																<tbody>
																</tbody>
															</table>
														</div>
													</div>
													<div class="modal-footer">
														<button class="btn btn-info" type="button"
															id="program-workflow-ok" data-dismiss="modal">
															<i class="fa fa-save"></i>&nbsp;&nbsp;OK
														</button>
													</div>
												</div>
											</div>
										</div>
										<div class="modal fade" id="myModal11" tabindex="-1"
											role="dialog" aria-labelledby="myModalLabel"
											aria-hidden="true">
											<div class="modal-dialog">
												<div class="modal-content">
													<div class="modal-header">
														<button id="program-save-modal-close" type="button"
															class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
														<h4 class="modal-title">Cancel Program Changes?</h4>
													</div>
													<div class="modal-body">
														<div class="space15">&nbsp;</div>
														<div class="text-center">Are you sure you want
															to cancel Changes? If you still want to cancel your
															changes, click the OK button. If you don't want to
															cancel your changes, click the "Cancel" button below
															and your program will not cancel these changes.</div>
														<div class="space15"></div>
													</div>
													<div class="modal-footer">
														<button data-dismiss="modal" class="btn btn-default"
															id="program-save-modal-cancel" type="button">Cancel</button>
														<a href="javascript: returnToPreviousPage()"><button
																class="btn btn-info" id="program-save-modal-ok"
																type="button">
																<i class="fa fa-save"></i>&nbsp;&nbsp;OK
															</button></a>
													</div>
												</div>
											</div>
										</div>
									</div>
								</form>
                        </div>
                </section>
            </div>
        </div><!-- END opening ROW -->
  </section>
  </section>
<!--main content end-->

  <!--footer start-->
      <footer class="site-footer">
         <div class="text-center">
            2017 &copy; Yokohama Tire Corporation. All rights reserved. The Yokohama Rubber Company Limited
            <a href="#" class="go-top">
            <i class="fa fa-angle-up"></i>
            </a>
         </div>
      </footer>
<!--footer end-->    
</section>
<!-- END section id="container" FIRST section after opening body tag  -->

	<!--Tooltips -->
       <script>
            $(document).ready(function(){
                $('input[rel="txtTooltip"]').tooltip();
            });
       </script>
       <script>
           $(function(){

            // Enabling Popover Example 1 - HTML (content and title from html tags of element)
            $("[data-toggle=popover]").popover();

            // Enabling Popover Example 2 - JS (hidden content and title capturing)
            $(".form-control").popover({
                html : true, 
                content: function() {
                  return $('.js-tooltip').html();
                },
                title: function() {
                  return $('.js-tooltip').html();
                }
            });


        });
           
       </script>
<script type="text/javascript">
	$(document).ready(function(){
          $('#workflow-status-table').dataTable({
			"oLanguage": {
				"sEmptyTable": "No data available in table"
			},
          	"iDisplayLength": 50,
          	"bDestroy": true,
          	"bSort": false,
          	"sPaginationType": "bootstrap",
          	"sDom": 't',
			"aoColumns": [
							{ "sClass": "text-left" },
							{ "sClass": "text-left" },
							{ "sClass": "text-left" },
							{ "sClass": "center" }
						]
       });
	});	
	
	function fnPopulateProgramWorkflowStatus(workflowStatus){
   		var table = $("#workflow-status-table").DataTable();
   		table.fnClearTable();
   		if(workflowStatus != null){
   			$.each(workflowStatus, function(idx, item) {
		var date = null;
		if(item.approvalDate != null){
			date = $.datepicker.formatDate( "mm/dd/yy", new Date(item.approvalDate));
		}
				table.fnAddData([item.approverName, item.approverRole, item.status, date]);
           });
   		}
   		table.fnDraw();
   	}
         	
</script>

	<script type="text/javascript">
	var responseOnload;
	var custId;
	var _isDirty = false;
	$(window).ready(function(){
			//getParams = new URLSearchParams(window.location.search);
			//var pricingHeaderId = getParams.get('pricingId'); 
			//custId = getParams.get('custId');
			//pricingHeaderId = '74';
			var queryDict = {};
	        window.location.search.substr(1).split("&").forEach(
	        function(item) {
	        queryDict[item.split("=")[0]] = item.split("=")[1]
            })
		    var custId=queryDict["custId"];
		    var pricingHeaderId=queryDict["pricingId"];
		    
			var url;
			
			if(pricingHeaderId == null){
				$("#reject-pricing").hide();
				$("#edit-button").hide();
				$("#approve-pricing").hide();
			}
			else{
				$("#cancel-pricing").html("Back");
				$("#edit-pricing").addClass("active");
			}
			
			if(pricingHeaderId != null){
				url = "/SIM/pricing/v1/getPricingDetail/" + pricingHeaderId; 
			}
			else if(custId != null){
				url = "/SIM/pricing/v1/getPricingDetails/" + custId;
			}
			/* if(custId != null){
				$('#cancelLink').attr('href','/SIM/pricingOverview?custId='+custId);
			}
			else{
				$('#cancelLink').attr('href','/SIM/indexRedirect');
			} */
			
			var invoiceDiscountHeader = ['ADD CHG DEL','BEG DATE','END DATE','PROD LINE','TREAD','PART#','NET PRICE','INVOICE DSC %','BONUS UNITS Y/N','COMM Y/N','COMMENT'];
        	$.ajax({ 
				type: "GET",
				cache: false,
				dataType: "json",
	           	url: url,
	           	async: false,
            	success: function(response){
	         		responseOnload = response.data;
	         		$('#businessUnitDescription').html(response.data.businessUnitDescription);
	         		$('#requestedBy').html(response.data.requestedByName);
	         		$('#requestedTitle').html(response.data.requestedByTitle);
	         		$('#requestedDate').html(response.data.requestedByDate);
	         		/* $('#approvedBy').html(response.data.approvedByName);
	         		$('#approvedTitle').html(response.data.approvedByTitle);
	         		$('#approvedDate').html(response.data.approvedByDate); */
	         		
					fnPopulateDropdown('termsCode_inputselect', response.data.dropdownList.termsCodeList);
			        $('#termsCode_inputselect').val(response.data.dropdownList.termsCodeList[0].key);
			 
			        if(response.data.dropdownList.termsCodeList[0].key == response.data.dropdownList.definitionList[0].key){
			       		$('#program_terms_definition').val(response.data.dropdownList.definitionList[0].value);
			       	}
			        if(response.data.dropdownList.termsCodeList[0].key == response.data.dropdownList.dueDatesList[0].key){
			       		$('#program_terms_duedates').val(response.data.dropdownList.dueDatesList[0].value);
			       	}
					if(response.data.dropdownList.termsCodeList[0].key == response.data.dropdownList.cashList[0].key){
			       		$('#program_terms_cash').val(response.data.dropdownList.cashList[0].value);
			       	}
					fnPopulateDropdown('Other_Ship_Reqs_inputselect', response.data.dropdownList.otherShipReqsList);
					fnPopulateDropdown('custByName_inputselect', responseOnload.dropdownList.custBillToList);
					$("#customerId").val(responseOnload.customerId);
					$("#customerGroup").val(responseOnload.customerGroup);
					
					if(responseOnload.dropdownList.groupList == null){
						$("input[type=radio][value='Group']").attr("disabled",true);
					}
										
					if(pricingHeaderId != null){
						$('#status').html(response.data.status);
						populateCustomerGroupDropDown(responseOnload.customerType);
						$("#custByName_inputselect").val(responseOnload.customerGroup);
						$("#customerGroup").val(responseOnload.customerGroupValue);
						$("#customerId").val(responseOnload.customerId);
						$('#termsCode_inputselect').val(responseOnload.termCode);
						
						/* $('#termsCode_inputselect').trigger('change'); trigger in this line is not working, need to check this.*/
						var checkDefn =responseOnload.dropdownList.definitionList;
						var checkDueDates=responseOnload.dropdownList.dueDatesList;
						var checkCash=responseOnload.dropdownList.cashList;
						fnPopulateProgramTerms('program_terms_definition', checkDefn,responseOnload.termCode);
						fnPopulateProgramTerms('program_terms_duedates', checkDueDates,responseOnload.termCode);
						fnPopulateProgramTerms('program_terms_cash', checkCash,responseOnload.termCode);				
				
						$('#user_comments').val(responseOnload.userComments);
						if(responseOnload.customerType == 'Group'){
							$("#optionsRadiosGroup").prop('checked', true);
						}
						else if(responseOnload.customerType == 'BillTo'){
							$("#optionsRadiosCustByBillTo").prop('checked', true);
						}
						else if(responseOnload.customerType == 'Name'){
							$("#optionsRadiosCustByName").prop('checked', true);
						}
						else if(responseOnload.customerType == 'ShipTo'){
							$("#optionsRadiosShipTo").prop('checked', true);
						}
						
						if(responseOnload.shippingReqs == '1000 LBS'){
							$("#optionsRadios1000lbs").prop('checked', true);
						}
						else if(responseOnload.shippingReqs == '2000 LBS'){
							$("#optionsRadios2000lbs").prop('checked', true);
						}
						else if(responseOnload.shippingReqs == 'Trailer Load'){
							$("#optionsRadiosTrailerLoad").prop('checked', true);
						}
						else if(responseOnload.shippingReqs == 'Per Program'){
							$("#optionsRadiosPerProgram").prop('checked', true);
						}
						$('#Other_Ship_Reqs_inputselect').val(responseOnload.otherShippingReqs);
						fnPopulateProgramWorkflowStatus(response.data.programWorkflowStatusList);
						fnPopulateInvoiceDiscountTable(responseOnload);
						disableFields();
						disableFieldBasedOnCurrentStatusAndUser(responseOnload);
						enabledButtonApplicableToAll();
						if(responseOnload.dropdownList.groupList == null){
							$("input[type=radio][value='Group']").attr("disabled",true);
						}
					}
					_isDirty = false;
            	},
            	failure: function(response){
            		alert("Wrongly done");
            	}
        	});

        	function disableFieldBasedOnCurrentStatusAndUser(responseOnload1){
         		if(responseOnload1.programButton.userLevel == "1" && responseOnload1.programButton.creater == true){
					$('#edit-button').attr('disabled', false);
					$('#edit-button').removeClass("disabled");
					hideApproverButtons();
					if(responseOnload1.newProgram == false && responseOnload1.status != 'REJECTED'){
	               		$('#submit-pricing').attr('disabled', false);
						$('#submit-pricing').removeClass("disabled");	
						$('#save-pricing').hide();
               		}
               		else if(responseOnload1.newProgram == false && responseOnload1.status === 'REJECTED'){
               			$('#save-pricing').show();
               			$('#submit-pricing').show();
               		}
               		else if(responseOnload1.newProgram == false){
               			showCreatorButtons();
               		}
				}
				else if(responseOnload1.programButton.approver == true){
					hideCreatorButtons();
					showApproverButtons();
					$('#edit-button').hide();
				}
				else{
					hideCreatorButtons();
					hideApproverButtons();
					$('#edit-button').hide();
				} 
        	}
        	
			function hideCreatorButtons(){
         		$('#save-pricing').hide();
         		$('#submit-pricing').hide();
         	}
         	
         	function showCreatorButtons(){
         		$('#save-pricing').show();
         		$('#save-pricing').attr('disabled', false);
         		$('#save-pricing').removeClass("disabled");
         		$('#submit-pricing').show();
         		$('#submit-pricing').attr('disabled', false);
         		$('#submit-pricing').removeClass("disabled");
         	}
         	
         	function hideApproverButtons(){
         		$('#reject-pricing').hide();
         		$('#approve-pricing').hide();
         	}
         	
         	function showApproverButtons(){
         		$('#reject-pricing').show();
         		$('#reject-pricing').attr('disabled', false);
         		$('#reject-pricing').removeClass("disabled");
         		$('#approve-pricing').show();
         		$('#approve-pricing').attr('disabled', false);
         		$('#approve-pricing').removeClass("disabled");
         	}
        	
        	function fnPopulateInvoiceDiscountTable(responseOnLoadInput){
        		if(responseOnLoadInput.pricingDetailList != null){
        			/* var editableCheck = true;
        			if(responseOnLoadInput.status === 'PENDING' || responseOnLoadInput.status === 'APPROVED' || responseOnLoadInput.status === 'ACTIVE'){
						editableCheck = false;
        			}  */
	        		var metadata = [];
	        		var data = [];
					var title = "Sheet1";
	        		for (var k = 0; k < invoiceDiscountHeader.length; ++k) {
						metadata.push({ name: invoiceDiscountHeader[k], label: invoiceDiscountHeader[k], datatype: "string", editable: false});
					}
					metadata.push({ name: 'ID', label: 'ID', datatype: "string", editable: false, hidden: true});
					$.each(responseOnLoadInput.pricingDetailList, function(idx, item) {
						var rowValues = {};
						rowValues[invoiceDiscountHeader[0]] = item.addChangeDel;
						var begindate = null;
       					if(item.beginDate != null){
       						begindate = $.datepicker.formatDate( "mm/dd/yy", new Date(item.beginDate));
       					}
						rowValues[invoiceDiscountHeader[1]] = begindate;
						var enddate = null;
						if(item.endDate != null){
							enddate = $.datepicker.formatDate( "mm/dd/yy", new Date(item.endDate));
						}
						rowValues[invoiceDiscountHeader[2]] = enddate;
						rowValues[invoiceDiscountHeader[3]] = item.prodLine;
						rowValues[invoiceDiscountHeader[4]] = item.tread;
						rowValues[invoiceDiscountHeader[5]] = item.part;
						rowValues[invoiceDiscountHeader[6]] = convertAmountFormat(parseInt(item.netPrice));
						rowValues[invoiceDiscountHeader[7]] = convertAmountFormat(parseInt(item.invoiceDisc)) + '%';
						rowValues[invoiceDiscountHeader[8]] = item.bonusUnits;
						rowValues[invoiceDiscountHeader[9]] = item.commissionable;
						rowValues[invoiceDiscountHeader[10]] = item.comments;
						rowValues['ID'] = item.id;
						
						data.push({id: idx, values: rowValues});
	                });
	                	                
					editableGrid = new EditableGrid(title, {
						modelChanged: function(rowId, colId, oldValue, newValue, row) {
							data[rowId].values[columnNames[colId]] = newValue;
						}
					});
					editableGrid.load({"metadata": metadata, "data": data});
					editableGrid.renderGrid("tablecontent", "testgrid","testgrid");
					fileData = data;
					dataUploaded = false;
        		}
        	}
        	
        	function populateCustomerGroupDropDown(type){
				if(type == 'Group'){
					fnPopulateDropdown('custByName_inputselect', responseOnload.dropdownList.groupList);
					$("#customerGroup").val($("#custByName_inputselect").val());
				}
				else if(type == 'BillTo'){
					fnPopulateDropdown('custByName_inputselect', responseOnload.dropdownList.custBillToList);
					$("#customerGroup").val($("#custByName_inputselect").val());
				}
				else if(type == 'Name'){
					fnPopulateDropdown('custByName_inputselect', responseOnload.dropdownList.custByNameList);
					$("#customerGroup").val($("#custByName_inputselect").val());
				}	
				else if(type == 'ShipTo'){
					fnPopulateDropdown('custByName_inputselect', responseOnload.dropdownList.custShipToList);
					$("#customerGroup").val($("#custByName_inputselect").val());
				}
        	}
        	
        	var test,selectTerm;
        	
			$("input[name=optionsRadiosSourcePathName]").on( "click", function() {
				test = $(this).val();
				if(test == 'Group'){
					fnPopulateDropdown('custByName_inputselect', responseOnload.dropdownList.groupList);
					/* $("#customerGroup").val($("#custByName_inputselect").val()); */
				}
				else if(test == 'BillTo'){
					fnPopulateDropdown('custByName_inputselect', responseOnload.dropdownList.custBillToList);
					/* $("#customerGroup").val($("#custByName_inputselect").val()); */
				}
				else if(test == 'Name'){
					fnPopulateDropdown('custByName_inputselect', responseOnload.dropdownList.custByNameList);
					/* $("#customerGroup").val($("#custByName_inputselect").val()); */
				}	else if(test == 'ShipTo'){
					fnPopulateDropdown('custByName_inputselect', responseOnload.dropdownList.custShipToList);
					/* $("#customerGroup").val($("#custByName_inputselect").val()); */
				}
  			});
  			
			/* $("select[name=custByName_inputselect]").on( "change", function() {
				var test = $(this).val();
				$("#customerGroup").val(test);
			}); */
			
			$("select[name=termsCode_inputselect]").on( "change", function() {
				selectTerm = $(this).val();
				var checkDefn =responseOnload.dropdownList.definitionList;
				var checkDueDates=responseOnload.dropdownList.dueDatesList;
				var checkCash=responseOnload.dropdownList.cashList;
				fnPopulateProgramTerms('program_terms_definition', checkDefn,selectTerm);
				fnPopulateProgramTerms('program_terms_duedates', checkDueDates,selectTerm);
				fnPopulateProgramTerms('program_terms_cash', checkCash,selectTerm);
			});
			
			function resetFormForMandatoryCheck(elementId){
			   	if( $('#'+ elementId).valid()){
			 		$('#'+ elementId).validate().resetForm(); 
				}
       		}
       		
       		function fnPopulateDropdown(elementId, items){
	        	if(items != null){
	        		$('#'+ elementId).empty();
	        		$.each(items, function (i, item) {
					    $('#'+ elementId).append($('<option>', { 
					        value: item.key,
					        text : item.value 
					    },'</option>' ));
				    
					});
				//resetFormForMandatoryCheck(elementId);
	        	}
	        	else{
	        		$('#'+ elementId).empty();
	        	}
			}
	function fnPopulateProgramTerms(elementId, items,item){
		var check = item;
       	if(items != null){
       	console.log(items);
       		$('#'+ elementId).empty();
       		$.each(items, function (i, item) {
		   /*  $('#'+ elementId).append($('<option>', { 
		        value: item.key,
		        text : item.value 
		    },'</option>' )); */
		    if(check == item.key){
		    $('#'+ elementId).val(item.value); 
		    }
		});
		//resetFormForMandatoryCheck(elementId);
       	}
	}	
	});
</script>

	<script type="text/javascript">
			var responseOnload = {};
		
			function approveProgram(){
				/**Approve program from here will always carry status as Pending,
				In service, after checking the approver level from matrix table, this will be
				changed to Approved if applicable.*/
				var message = "Data approved successfully !!!";
         		var idBefore = responseOnload.id;
				responseOnload.status = "2";
				responseOnload.url = window.location.href;
				responseOnload.approverComments = $("#approveComments").val();
				fnCallService(message, idBefore);
				$('#myModal7').modal('toggle');
				disableFields();
			}
			
			function rejectProgram(){
				var message = "Data rejected successfully !!!";
         		var idBefore = responseOnload.id;
				responseOnload.status = "1";
				responseOnload.url = window.location.href;
				responseOnload.approverComments = $("#rejectionComments").val();
				fnCallService(message, idBefore);
				$('#myModal8').modal('toggle');
				disableFields();
			}
			
			function saveDraft(){
				var message = "Data saved successfully !!!";
         		var idBefore = responseOnload.id;
         		responseOnload.status = "3";
         		responseOnload.url = window.location.href;
         		prepareDataForSubmit();
         		fnCallService(message, idBefore);
         		$('#myModal1').modal('toggle');
         	}
         	
         	function submitForApproval(){
         		var message = "Data submitted for approval successfully !!!";
         		var idBefore = responseOnload.id;
         		responseOnload.status = "2";
         		responseOnload.url = window.location.href;
         		if(idBefore === null || _isDirty){
         			prepareDataForSubmit();
         		}
         		
         		fnCallService(message, idBefore);
         		$('#myModal').modal('toggle');
         		disableFields();
         	}
         	
         	var formData=[];
         	function prepareDataForSubmit(){
         		//responseOnload.url = window.location.href;
				formData= $('form#pricingRequest').serializeArray();
				responseOnload.customerType=formData[0].value;
				responseOnload.customerGroup=formData[1].value;
				responseOnload.customerId=formData[2].value;
				responseOnload.userComments=formData[4].value;
				responseOnload.termCode=formData[5].value;
				responseOnload.definition=formData[6].value;
				responseOnload.dueDates=formData[7].value;
				responseOnload.cash=formData[8].value;
				responseOnload.shippingReqs=formData[9].value;
				responseOnload.otherShippingReqs=formData[10].value;
				responseOnload.success=false;
				var fileDataList = [];
			
				$.each(fileData, function(key, data) {
					console.log( $.datepicker.parseDate( "mm/dd/yy", data.values['BEG DATE']));
					var fileDataRow = {'id': data.values['ID'], 'programId': data.id, 'part':data.values[' PART#'], 'addChangeDel': data.values['ADD CHG DEL'], 'beginDate':  $.datepicker.parseDate( "mm/dd/yy", data.values['BEG DATE']), 'bonusUnits': data.values['BONUS UNITS Y/N'], 'commissionable': data.values['COMM Y/N'], 'comments': data.values['COMMENT'], 'endDate':  $.datepicker.parseDate( "mm/dd/yy", data.values['END DATE']), 'invoiceDisc': data.values['INVOICE DSC %'],'netPrice': removeCommaFromAmount(data.values['NET PRICE']), 'prodLine': data.values['PROD LINE'], 'tread': data.values['TREAD'] };
					fileDataList.push(fileDataRow);
				});
				//console.log(fileDataList);
				responseOnload.pricingDetailList=fileDataList;
						
 			}
         	function fnCallService(message, idBefore){
				/*Service call to save the data.*/	
			    $.ajax({
					type: "POST",
					url: "/SIM/pricing/v1/savePricingDetails",
					dataType: 'json',
					contentType: 'application/json',
					data: JSON.stringify(responseOnload),
					success: function (response) {
			            if (response != null && response.data.success == true) {
			            	responseOnload = response.data;
			            	$('#status').html(response.data.status);
			            	fnPopulateProgramWorkflowStatus(response.data.programWorkflowStatusList);
							/**Appending program id in the modal message.- Begin*/
							var idAfter = responseOnload.id;
							if(idBefore != idAfter){
								var newMessage = "New pricing id generated : <strong>"+ idAfter + "</strong><br> <br>"+ message;
								message = newMessage; 
							}
							/**Appending program id in the modal message.- End*/
         					$("#confirmMessage").html(message);
							$('#myModal4').modal('toggle');
							if(dataUploaded){
								dataUploaded = false;
								//fnPopulateInvoiceDiscountTable(responseOnload);
							}
							_isDirty = false;
			            } else {
			              	$('#myModal1').modal('toggle');
         					$("#errorMessage").html("Issue while saving the data. Please correct the following data.!!"+'<br><br>'+response.data.validationMessage);
							$('#myModal5').modal('toggle');
			            
							//alert("Issue while saving the data. Please try again after sometime.!!");
			            }
			            
					},
					failure: function(response){
					 	$('#myModal1').modal('toggle');
         				$("#errorMessage").html("Issue while saving the data. Please try again after sometime.!!");
						$('#myModal5').modal('toggle');
						//alert("Issue while saving the data. Please try again after sometime.!!");
					}
			    });
			}
			function validateBeforeSubmit(modalId){
				/**If valid, it will toggle the corresponding modal.
				If there is some error, error modal will be toggled.*/
				if( ( fileData === null || fileData.length === undefined || fileData.length <= 0) && 
													( ($('#xlf').val()=="")||($('#xlf').val()==null) )){
					$("#errorMessageModal").html("Please upload the Pricing Request file !!!");
					$('#myModal6').modal('toggle');	
					return;
				}
				 if($("#pricingRequest").valid()){
					$(modalId).modal('toggle');
				}
				else{
					$("#errorMessageModal").html("Please rectify the highlighted errors !!!");
					$('#myModal6').modal('toggle');
				} 
			}
			function disableFields(){
				$('#pricing-parent-div').find('input, textarea, button, select, a').attr('disabled',true);
				$("#pricing-parent-div").find('a').addClass("disabled");
				enabledButtonApplicableToAll();
				$("#cancel-pricing").html("Back");
			}
			
			function enableFields(){
				$('#pricing-parent-div').find('input, textarea, button, select, a').attr('disabled',false);
				$("#pricing-parent-div").find('a').removeClass("disabled");
				$('#myModalEdit').modal('toggle');
				if(responseOnload.newProgram == false){
					$('#save-pricing').show();
               	}
               	$('#edit-button').attr('disabled', true);
				$('#edit-button').addClass("disabled");
				$("#cancel-pricing").html("Cancel");
			}
			
			function enabledButtonApplicableToAll(){
				$('#pricing-expand').attr('disabled', false);
				$('#pricing-expand').removeClass("disabled");
				/* $('#pdf-button').attr('disabled', false); */
				$('#cancel-pricing').attr('disabled', false);
				$('#cancelLink').attr('disabled', false);
				$('#cancelLink').removeClass("disabled");
				$('#myModalEdit').find('button').attr('disabled',false);
				$('#myModal').find('button').attr('disabled',false);
				$('#myModal1').find('button').attr('disabled',false);
				$('#myModal4').find('button').attr('disabled',false);
				$('#myModal5').find('button').attr('disabled',false);
				$('#myModal6').find('button').attr('disabled',false);
				$('#myModal7').find('button, a, textarea').attr('disabled',false);
				$('#myModal8').find('button, a, textarea').attr('disabled',false);
				$('#myModal9').find('button, a, textarea').attr('disabled',false);
				$('#myModal11').find('button, a, textarea').attr('disabled',false);
				$('#header-button').removeAttr('hidden');
				$('#pricing-workflow-btn').attr('disabled', false); 
				$('#view-program-workflow').attr('disabled', false);
				$('#view-program-workflow').removeClass("disabled");
				
				/* $('#invoice-export-link').attr('disabled', false);
				$('#invoice-export-link').removeClass("disabled"); */
				$('#invoice-export-btn').attr('disabled', false); 
				/* $('#myModal5').find('button').attr('disabled',false);
				$('#myModal4').find('button').attr('disabled',false);
				$('#myModal7').find('button, a, textarea').attr('disabled',false);
				$('#myModal8').find('button, a, textarea').attr('disabled',false);
				$('#myModal9').find('button, a, textarea').attr('disabled',false);
				$('#myModal10').find('button, a, textarea').attr('disabled',false);
				$('#header-button').removeAttr('hidden');
				$('#footer-button').removeAttr('hidden');
				$('#view-program-workflow').attr('disabled', false);
				$('#view-program-workflow').removeClass("disabled");
				$('#program-workflow-btn').attr('disabled', false); */
			}
			
			$(':input').change(function(){
				_isDirty = true;
			});
	</script>
	<!--  Validation setup Begins -->
    <script type="text/javascript">
      $(document).ready(function () {
			/* $.validator.addMethod("actualMarkerCheck", function (value, element) {
				var isSame = false;
                    $('#tier-schedule tbody').find('tr').each(function(i) {
                    	 var tds = $(this).find('td'),
                         marker = tds.eq(0).text();
                    	 if(marker==value){
                    	 	isSame = true;
                    	 }
                    });							
			    return isSame;
			}, 'Accrued Tier should match maker value available'); */
      
			$('#xlf').click(function(){
				 this.value = null;
			 });
			
			$("#pricingRequest").validate({
				rules: {
					optionsRadiosSourcePathName: {
						required: true
					},
					custByName_inputselect:{
						required: true
					},
					 customerId: {
						required: true
					},
 					termsCode_inputselect: {
						required: true
					},
					optionsRadiosShippingProgram: {
						required: true
					},
					Other_Ship_Reqs_inputselect:{
						required: true
					},
					
				},
				messages: {
					required: "This field is required",
				   	/* amount: {
					   	number: "Please enter only numeric values"
				   	}, */
				}
			});
			});
          	/* var form = $("#wizard-validation-form");
			onFinishing: {
			    form.validate().settings.ignore = ":disabled";
			    return form.valid();
			}
			onFinished: {
			       alert("You've successfully submitted this program for approval. You'll be notified of its status soon."); 
			       location.href = 'index.html#pending-approvals';
			} */
  </script>
  <!--  Validation setup Ends -->

	<script type="text/javascript">
	       				
			function cancelClick(modalId){
				if(_isDirty){
					$(modalId).modal('toggle');
				}
				else{
					returnToPreviousPage();
				}
					
			}
			
			function returnToPreviousPage(){
				if(custId != null){
				 	window.location.href='/SIM/pricingOverview?custId='+custId; 
				}
				else{
					window.location.href='/SIM/indexRedirect';
				}
			}  
			
			    		
    		$('#myModal7').on('shown.bs.modal', function () {
			    $('#approveComments').focus();
			});
			
			$('#myModal8').on('shown.bs.modal', function () {
			    $('#rejectionComments').focus();
			})
			
			function convertAmountFormat(amount){
				if(amount != null && amount != 0){
					/*Remove comma's if already present*/
					amount = amount.toString().replace(/,/g, "");
					if(!isNaN(amount)){
						amount = parseFloat(amount).toFixed(2);
						var withCommas = Number(amount).toLocaleString('en',
																{ minimumFractionDigits: 2 });
																
						return withCommas;
					}
				}
				
				return amount;
			}   
			
			function removeCommaFromAmount(amount){
				if(amount != null){
					return amount.toString().replace(/\,/g,'');
				}
			}   	
	</script>

    <script>
        $(function(){
		
		 $('.popovers').popover();

         // Enabling Popover Example 1 - HTML (content and title from html tags of element)
         $("[data-toggle=popover]").popover();

         // Enabling Popover Example 2 - JS (hidden content and title capturing)
         $(".form-control").popover({
             html : true, 
             content: function() {
               return $('.js-tooltip').html();
             },
             title: function() {
               return $('.js-tooltip').html();
             }
         });


     });
        
    </script>

	<script>
	    $(function(){
	        $('html').keydown(function(e){
	            var key = e.which;
	            if(e.altKey == true && key == 37) { //37 - left arrorw
	                e.preventDefault();
            		console.log("e.altKey : "+e.altKey +" key : "+key);
	            	$.ajax({
	         			type: "POST",
	         			url: "/SIM/browserclose",
	         			dataType: 'json',
	         			contentType: 'application/json',
	         			data: {}
	         	    }); 
	         	    window.location="login"; 
	            }
	            
	        });
	    });
    </script>
  </body>
</html>
